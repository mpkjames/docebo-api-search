<!DOCTYPE html>
<!-- This file was created with the assistance of an Google Gemini 2.5 Pro AI model. -->
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Docebo API Searcher</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            // This is the configuration for Tailwind CSS, telling it to use the 'class' strategy for dark mode.
            // This allows us to toggle dark mode manually with JavaScript.
            tailwind.config = {
                darkMode: "class",
            };
        </script>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Figtree:wght@700&family=Inter:wght@400;500;600;700&display=swap"
            rel="stylesheet"
        />
        <style>
            html {
                scroll-behavior: smooth;
            }
            body {
                font-family: "Inter", sans-serif;
            }
            .font-figtree {
                font-family: "Figtree", sans-serif;
            }
            .spinner {
                border: 4px solid rgba(0, 0, 0, 0.1);
                width: 36px;
                height: 36px;
                border-radius: 50%;
                border-left-color: #09f;
                animation: spin 1s ease infinite;
            }
            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }
            .endpoint-details {
                max-height: 0;
                overflow: hidden;
                transition: max-height 0.5s ease-out;
            }
            .endpoint-details.expanded {
                max-height: 3500px; /* Increased max-height for potentially long schemas */
                transition: max-height 0.5s ease-in;
            }
            .collapsible-content {
                display: grid;
                grid-template-rows: 0fr;
                transition: grid-template-rows 0.5s ease-in-out;
            }
            .collapsible-content > div {
                overflow: hidden;
            }
            .collapsible-content.expanded {
                grid-template-rows: 1fr;
            }
            /* NEW STYLES FOR STICKY HEADER SEARCH ANIMATION */
            .collapsible-sticky-search {
                max-height: 0;
                overflow: hidden;
                transition: max-height 0.35s ease-in-out;
            }
            .collapsible-sticky-search.expanded {
                max-height: 400px; /* Increased from 300px to ensure all 4 search boxes are visible */
            }
            @media (min-width: 768px) {
                /* md breakpoint */
                .collapsible-sticky-search {
                    max-height: none;
                    overflow: visible;
                }
            }
            /* END NEW STYLES */
            .param-table {
                table-layout: fixed;
                width: 100%;
            }
            .param-table td {
                word-wrap: break-word;
            }
            /* Always-visible scrollbar for code blocks */
            .code-block-container pre::-webkit-scrollbar {
                width: 8px;
                height: 8px;
            }
            .code-block-container pre::-webkit-scrollbar-track {
                background: #2d3748; /* gray-800 */
            }
            .code-block-container pre::-webkit-scrollbar-thumb {
                background-color: #4a5568; /* gray-600 */
                border-radius: 4px;
            }
            .code-block-container pre::-webkit-scrollbar-thumb:hover {
                background-color: #718096; /* gray-500 */
            }
            .highlight-body-field {
                background-color: rgba(
                    236,
                    72,
                    153,
                    0.3
                ); /* pink-500 with opacity, slightly brighter */
                border-radius: 3px;
                padding: 1px 3px;
            }
            .highlight-response-field {
                background-color: rgba(
                    253,
                    186,
                    116,
                    0.4
                ); /* orange-300 with opacity */
                border-radius: 3px;
                padding: 1px 3px;
            }
            .tooltip-text {
                visibility: hidden;
                opacity: 0;
                transition: opacity 0.3s;
            }
            .tooltip-container:hover .tooltip-text {
                visibility: visible;
                opacity: 1;
            }
            .code-line {
                display: flex;
            }
            .line-number {
                min-width: 2.5em; /* Space for line numbers */
                padding-right: 1em;
                text-align: right;
                user-select: none;
                color: #6b7280; /* gray-500 */
            }
            .dark .line-number {
                color: #4b5563; /* gray-600 */
            }
            pre.no-wrap .line-content {
                white-space: pre;
            }
            pre.word-wrap .line-content {
                white-space: pre-wrap;
                overflow-wrap: break-word;
            }
            /* Hide the default search input cancel button */
            input[type="search"]::-webkit-search-cancel-button {
                -webkit-appearance: none;
                appearance: none;
            }
            .comment-required {
                color: #9a8f8f; /* Hint of red */
                font-weight: 500;
            }
            .comment-optional {
                color: #9a9a8f; /* Hint of yellow */
                font-weight: 500;
            }
            .help-modal-content pre {
                white-space: pre-wrap;
            }
        </style>
    </head>
    <body
        class="bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300 transition-colors duration-300 flex flex-col min-h-screen"
    >
        <!-- Sticky Header -->
        <div
            id="sticky-header"
            class="hidden fixed top-0 left-0 right-0 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm shadow-md z-50 transition-transform duration-300 ease-in-out transform -translate-y-full"
        >
            <div class="container mx-auto p-3 flex flex-col gap-2">
                <!-- Top Row: Title and View Toggle -->
                <div class="flex items-center justify-between w-full">
                    <div class="flex items-center gap-3 flex-shrink-0">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="h-8 w-8 text-blue-600"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                            stroke-width="2"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 10.5a.5.5 0 01.5-.5h3a.5.5 0 010 1h-3a.5.5 0 01-.5-.5zM10 13.5a.5.5 0 01.5-.5h3a.5.5 0 010 1h-3a.5.5 0 01-.5-.5z"
                            />
                        </svg>
                        <h2
                            class="text-xl font-bold text-gray-800 dark:text-white font-figtree hidden sm:block"
                        >
                            Docebo API Searcher
                        </h2>
                    </div>
                    <div class="flex items-center justify-end gap-2">
                        <div
                            id="sticky-view-toggle-container"
                            class="flex items-center justify-start gap-2 flex-shrink-0"
                        >
                            <h3
                                class="text-sm font-semibold text-gray-800 dark:text-gray-200 hidden md:block"
                            >
                                View:
                            </h3>
                            <div
                                id="sticky-view-toggle-switch"
                                class="relative flex items-center rounded-lg bg-gray-200 dark:bg-gray-700 p-1 w-40 transition-colors duration-500"
                            >
                                <div
                                    id="sticky-view-toggle-indicator"
                                    class="absolute top-1 left-1 h-[calc(100%-0.5rem)] w-[calc(50%-0.25rem)] bg-white dark:bg-gray-600 rounded-md shadow transition-transform duration-300 ease-in-out"
                                ></div>
                                <button
                                    id="stickySimpleViewBtn"
                                    class="relative w-1/2 py-1 text-sm font-semibold z-10 transition-colors"
                                >
                                    Simple
                                </button>
                                <button
                                    id="stickyDetailedViewBtn"
                                    class="relative w-1/2 py-1 text-sm font-semibold z-10 transition-colors"
                                >
                                    Detailed
                                </button>
                            </div>
                        </div>
                        <button
                            id="toggleStickySearchBtn"
                            class="p-2 rounded-lg md:hidden hover:bg-gray-200 dark:hover:bg-gray-700"
                        >
                            <svg
                                id="toggleStickySearchIcon"
                                class="w-6 h-6 text-gray-700 dark:text-gray-300 transition-transform duration-300"
                                fill="none"
                                stroke="currentColor"
                                viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg"
                            >
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M19 9l-7 7-7-7"
                                ></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <!-- Collapsible Search Area -->
                <div
                    id="stickySearchArea"
                    class="collapsible-sticky-search md:block pt-2"
                >
                    <!-- Bottom Row: Search Boxes -->
                    <div class="w-full grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label
                                class="text-xs font-semibold text-gray-600 dark:text-gray-400"
                                >Path Name</label
                            >
                            <div class="relative">
                                <input
                                    type="search"
                                    id="stickySearchInput"
                                    class="w-full p-2 border border-gray-300 rounded-lg focus:border-blue-500 transition dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"
                                    placeholder="e.g., /users/{user_id}"
                                />
                                <button
                                    id="stickyClearSearchInputBtn"
                                    class="hidden absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white"
                                >
                                    <svg
                                        class="w-5 h-5"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="mt-1 flex items-center">
                                <input
                                    id="stickyPathIncludeDescCheck"
                                    type="checkbox"
                                    class="h-3 w-3 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-500"
                                />
                                <label
                                    for="stickyPathIncludeDescCheck"
                                    class="ml-1.5 block text-xs text-gray-600 dark:text-gray-400"
                                    >Also search description</label
                                >
                            </div>
                        </div>
                        <div>
                            <label
                                class="text-xs font-semibold text-gray-600 dark:text-gray-400"
                                >Parameter</label
                            >
                            <div class="relative">
                                <input
                                    type="search"
                                    id="stickyParamSearchInput"
                                    class="w-full p-2 border border-gray-300 rounded-lg focus:border-blue-500 transition dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"
                                    placeholder="e.g., sort_by"
                                />
                                <button
                                    id="stickyClearParamSearchInputBtn"
                                    class="hidden absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white"
                                >
                                    <svg
                                        class="w-5 h-5"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="mt-1 flex items-center">
                                <input
                                    id="stickyParamIncludeDescCheck"
                                    type="checkbox"
                                    class="h-3 w-3 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-500"
                                />
                                <label
                                    for="stickyParamIncludeDescCheck"
                                    class="ml-1.5 block text-xs text-gray-600 dark:text-gray-400"
                                    >Also search description</label
                                >
                            </div>
                        </div>
                        <div>
                            <label
                                class="text-xs font-semibold text-gray-600 dark:text-gray-400"
                                >Body Field</label
                            >
                            <div class="relative">
                                <input
                                    type="search"
                                    id="stickyBodySearchInput"
                                    class="w-full p-2 border border-gray-300 rounded-lg focus:border-blue-500 transition dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"
                                    placeholder="e.g., user_id"
                                />
                                <button
                                    id="stickyClearBodySearchInputBtn"
                                    class="hidden absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white"
                                >
                                    <svg
                                        class="w-5 h-5"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="mt-1 flex items-center">
                                <input
                                    id="stickyBodyIncludeDescCheck"
                                    type="checkbox"
                                    class="h-3 w-3 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-500"
                                />
                                <label
                                    for="stickyBodyIncludeDescCheck"
                                    class="ml-1.5 block text-xs text-gray-600 dark:text-gray-400"
                                    >Also search description</label
                                >
                            </div>
                        </div>
                        <div>
                            <label
                                class="text-xs font-semibold text-gray-600 dark:text-gray-400"
                                >Response Field</label
                            >
                            <div class="relative">
                                <input
                                    type="search"
                                    id="stickyResponseSearchInput"
                                    class="w-full p-2 border border-gray-300 rounded-lg focus:border-blue-500 transition dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"
                                    placeholder="e.g., first_name"
                                />
                                <button
                                    id="stickyClearResponseSearchInputBtn"
                                    class="hidden absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white"
                                >
                                    <svg
                                        class="w-5 h-5"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="mt-1 flex items-center">
                                <input
                                    id="stickyResponseIncludeDescCheck"
                                    type="checkbox"
                                    class="h-3 w-3 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-500"
                                />
                                <label
                                    for="stickyResponseIncludeDescCheck"
                                    class="ml-1.5 block text-xs text-gray-600 dark:text-gray-400"
                                    >Also search description</label
                                >
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container mx-auto p-4 md:p-8 flex-grow">
            <div class="bg-white rounded-2xl shadow-lg p-8 dark:bg-gray-800">
                <div class="flex justify-between items-start">
                    <div class="flex items-center gap-4 mb-2">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="h-10 w-10 text-blue-600"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                            stroke-width="2"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 10.5a.5.5 0 01.5-.5h3a.5.5 0 010 1h-3a.5.5 0 01-.5-.5zM10 13.5a.5.5 0 01.5-.5h3a.5.5 0 010 1h-3a.5.5 0 01-.5-.5z"
                            />
                        </svg>
                        <h1
                            class="text-5xl font-bold text-gray-900 font-figtree dark:text-white"
                        >
                            Docebo API Searcher
                        </h1>
                    </div>
                    <button
                        id="theme-toggle"
                        type="button"
                        class="text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5"
                    >
                        <!-- Lightbulb ON Icon (Yellow, shows in light mode) -->
                        <svg
                            id="theme-toggle-dark-icon"
                            class="hidden w-6 h-6 text-yellow-500"
                            fill="currentColor"
                            viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7zM14 20H10v1h4v-1zm0-2H10v1h4v-1z"
                            ></path>
                        </svg>
                        <!-- Lightbulb OFF Icon (Gray, shows in dark mode) -->
                        <svg
                            id="theme-toggle-light-icon"
                            class="hidden w-6 h-6 text-gray-400"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7zM14 20h-4v1h4v-1zm0-2h-4v1h4v-1z"
                            ></path>
                        </svg>
                    </button>
                </div>
                <p class="text-gray-600 mb-6 pl-14 dark:text-gray-400">
                    Enter the base URL for your Docebo instance to discover
                    available API services and their endpoints.
                </p>

                <div class="flex flex-col sm:flex-row gap-4 mb-8">
                    <input
                        type="text"
                        id="baseUrlInput"
                        class="flex-grow p-3 border border-gray-300 rounded-lg focus:border-blue-500 transition dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:border-blue-500"
                        placeholder="e.g., mj-michael-james.docebosaas.com"
                        value="mj-michael-james.docebosaas.com"
                    />
                    <button
                        id="fetchButton"
                        class="bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition duration-300 ease-in-out transform hover:scale-105"
                    >
                        Fetch API Endpoints
                    </button>
                </div>

                <div
                    id="controls-container"
                    class="hidden items-center justify-between gap-4 mb-6"
                >
                    <div class="flex items-center justify-start gap-4">
                        <h3
                            class="text-lg font-semibold text-gray-800 dark:text-gray-200"
                        >
                            View Mode:
                        </h3>
                        <div
                            id="view-toggle-switch"
                            class="relative flex items-center rounded-lg bg-gray-200 dark:bg-gray-700 p-1 w-40 transition-colors duration-500"
                        >
                            <div
                                id="view-toggle-indicator"
                                class="absolute top-1 left-1 h-[calc(100%-0.5rem)] w-[calc(50%-0.25rem)] bg-white dark:bg-gray-600 rounded-md shadow transition-transform duration-300 ease-in-out"
                            ></div>
                            <button
                                id="simpleViewBtn"
                                class="relative w-1/2 py-1 text-sm font-semibold z-10 transition-colors"
                            >
                                Simple
                            </button>
                            <button
                                id="detailedViewBtn"
                                class="relative w-1/2 py-1 text-sm font-semibold z-10 transition-colors"
                            >
                                Detailed
                            </button>
                        </div>
                    </div>
                    <button
                        id="helpButton"
                        class="flex items-center gap-2 text-sm font-semibold py-2 px-4 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 transition"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="h-5 w-5"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                            stroke-width="2"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                            />
                        </svg>
                        Help
                    </button>
                </div>

                <div
                    id="detailed-view-warning"
                    class="hidden relative text-sm text-amber-800 bg-amber-100 dark:bg-amber-900/40 dark:text-amber-300 p-4 pl-5 rounded-lg -mt-2 mb-4"
                >
                    <strong>Heads Up:</strong>&nbsp;Detailed view may be less
                    responsive on an unfiltered list of endpoints. For the best
                    experience, try searching first in 'Simple' mode, then
                    switch to 'Detailed' view. When clearing a search or
                    re-fecthing a platform's endpoints the view is reset.
                    <button
                        id="close-warning-btn"
                        class="absolute top-2 right-2 p-1 rounded-md hover:bg-amber-200 dark:hover:bg-amber-800/50"
                    >
                        <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            ></path>
                        </svg>
                    </button>
                </div>

                <div id="search-container" class="hidden my-6">
                    <div class="flex justify-between items-center mb-3">
                        <h3
                            class="text-lg font-semibold text-gray-800 dark:text-gray-200"
                        >
                            Search for APIs
                        </h3>
                        <button
                            id="clearAllButton"
                            class="text-xs font-semibold py-1 px-3 rounded-full bg-blue-100 text-blue-700 hover:bg-blue-200 transition disabled:opacity-50 disabled:cursor-not-allowed"
                            disabled
                        >
                            Reset All Search Boxes
                        </button>
                    </div>
                    <div
                        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"
                    >
                        <!-- Path/Description Search -->
                        <div>
                            <div class="flex items-center gap-2 mb-1">
                                <label
                                    class="text-sm font-medium text-gray-700 dark:text-gray-300"
                                    >Path Name</label
                                >
                                <div class="relative tooltip-container">
                                    <svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        class="h-4 w-4 text-gray-400"
                                        fill="none"
                                        viewBox="0 0 24 24"
                                        stroke="currentColor"
                                        stroke-width="2"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                                        />
                                    </svg>
                                    <div
                                        class="tooltip-text absolute z-10 -top-2 -translate-y-full w-60 p-2 text-xs text-white bg-gray-700 rounded-lg shadow-lg"
                                    >
                                        Search for text in the API endpoint
                                        path. Check box to also search
                                        summary/description.
                                    </div>
                                </div>
                            </div>
                            <div class="relative">
                                <input
                                    type="search"
                                    id="searchInput"
                                    class="w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 transition dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"
                                    placeholder="e.g., /users/{user_id}"
                                />
                                <button
                                    id="clearSearchInputBtn"
                                    class="hidden absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white"
                                >
                                    <svg
                                        class="w-5 h-5"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="mt-2 flex items-center">
                                <input
                                    id="pathIncludeDescCheck"
                                    type="checkbox"
                                    class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-500"
                                />
                                <label
                                    for="pathIncludeDescCheck"
                                    class="ml-2 block text-sm text-gray-700 dark:text-gray-300"
                                    >Also search description</label
                                >
                            </div>
                        </div>
                        <!-- Parameter Search -->
                        <div>
                            <div class="flex items-center gap-2 mb-1">
                                <label
                                    class="text-sm font-medium text-gray-700 dark:text-gray-300"
                                    >Parameter Name</label
                                >
                                <div class="relative tooltip-container">
                                    <svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        class="h-4 w-4 text-gray-400"
                                        fill="none"
                                        viewBox="0 0 24 24"
                                        stroke="currentColor"
                                        stroke-width="2"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                                        />
                                    </svg>
                                    <div
                                        class="tooltip-text absolute z-10 -top-2 -translate-y-full w-60 p-2 text-xs text-white bg-gray-700 rounded-lg shadow-lg"
                                    >
                                        Search for a specific query, path, or
                                        header parameter by name. Highlights in
                                        yellow.
                                    </div>
                                </div>
                            </div>
                            <div class="relative">
                                <input
                                    type="search"
                                    id="paramSearchInput"
                                    class="w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 transition dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"
                                    placeholder="e.g., sort_by"
                                />
                                <button
                                    id="clearParamSearchInputBtn"
                                    class="hidden absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white"
                                >
                                    <svg
                                        class="w-5 h-5"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="mt-2 flex items-center">
                                <input
                                    id="paramIncludeDescCheck"
                                    type="checkbox"
                                    class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-500"
                                />
                                <label
                                    for="paramIncludeDescCheck"
                                    class="ml-2 block text-sm text-gray-700 dark:text-gray-300"
                                    >Also search description</label
                                >
                            </div>
                        </div>
                        <!-- Body Field Search -->
                        <div>
                            <div class="flex items-center gap-2 mb-1">
                                <label
                                    class="text-sm font-medium text-gray-700 dark:text-gray-300"
                                    >Request Body Field</label
                                >
                                <div class="relative tooltip-container">
                                    <svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        class="h-4 w-4 text-gray-400"
                                        fill="none"
                                        viewBox="0 0 24 24"
                                        stroke="currentColor"
                                        stroke-width="2"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                                        />
                                    </svg>
                                    <div
                                        class="tooltip-text absolute z-10 -top-2 -translate-y-full w-60 p-2 text-xs text-white bg-gray-700 rounded-lg shadow-lg"
                                    >
                                        Search for a field within the JSON
                                        request body. Highlights in pink.
                                    </div>
                                </div>
                            </div>
                            <div class="relative">
                                <input
                                    type="search"
                                    id="bodySearchInput"
                                    class="w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 transition dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"
                                    placeholder="e.g., user_id"
                                />
                                <button
                                    id="clearBodySearchInputBtn"
                                    class="hidden absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white"
                                >
                                    <svg
                                        class="w-5 h-5"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="mt-2 flex items-center">
                                <input
                                    id="bodyIncludeDescCheck"
                                    type="checkbox"
                                    class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-500"
                                />
                                <label
                                    for="bodyIncludeDescCheck"
                                    class="ml-2 block text-sm text-gray-700 dark:text-gray-300"
                                    >Also search description</label
                                >
                            </div>
                        </div>
                        <!-- Response Field Search -->
                        <div>
                            <div class="flex items-center gap-2 mb-1">
                                <label
                                    class="text-sm font-medium text-gray-700 dark:text-gray-300"
                                    >Response Body Field</label
                                >
                                <div class="relative tooltip-container">
                                    <svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        class="h-4 w-4 text-gray-400"
                                        fill="none"
                                        viewBox="0 0 24 24"
                                        stroke="currentColor"
                                        stroke-width="2"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                                        />
                                    </svg>
                                    <div
                                        class="tooltip-text absolute z-10 -top-2 -translate-y-full w-60 p-2 text-xs text-white bg-gray-700 rounded-lg shadow-lg"
                                    >
                                        Search for a field within the JSON
                                        example response. Highlights in orange.
                                    </div>
                                </div>
                            </div>
                            <div class="relative">
                                <input
                                    type="search"
                                    id="responseSearchInput"
                                    class="w-full p-3 border border-gray-300 rounded-lg focus:border-blue-500 transition dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"
                                    placeholder="e.g., first_name"
                                />
                                <button
                                    id="clearResponseSearchInputBtn"
                                    class="hidden absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white"
                                >
                                    <svg
                                        class="w-5 h-5"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12"
                                        ></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="mt-2 flex items-center">
                                <input
                                    id="responseIncludeDescCheck"
                                    type="checkbox"
                                    class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-500"
                                />
                                <label
                                    for="responseIncludeDescCheck"
                                    class="ml-2 block text-sm text-gray-700 dark:text-gray-300"
                                    >Also search description</label
                                >
                            </div>
                        </div>
                    </div>
                </div>

                <div id="nav-container" class="hidden">
                    <div class="flex justify-between items-center mb-3">
                        <h3
                            class="text-lg font-semibold text-gray-800 dark:text-gray-200"
                        >
                            Jump to...
                        </h3>
                        <div class="flex gap-2">
                            <button
                                id="sortAZButton"
                                title="Sort services alphabetically"
                                class="text-xs font-semibold py-1 px-3 rounded-full bg-blue-100 text-blue-700 hover:bg-blue-200 transition disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                Sort A-Z
                            </button>
                            <button
                                id="resetSortButton"
                                title="Reset to original sort order"
                                class="text-xs font-semibold py-1 px-3 rounded-full bg-blue-100 text-blue-700 hover:bg-blue-200 transition disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                Reset Sort
                            </button>
                        </div>
                    </div>
                    <div
                        id="nav-links"
                        class="flex flex-wrap gap-2 pb-4 border-b border-gray-200 dark:border-gray-700 mb-6"
                    ></div>
                </div>

                <div
                    id="expand-collapse-container"
                    class="hidden flex justify-between items-center gap-2 mb-4"
                >
                    <div
                        id="total-api-count"
                        class="text-gray-600 dark:text-gray-400 text-sm font-semibold"
                    ></div>
                    <div class="flex items-center gap-2">
                        <button
                            id="resetFiltersButton"
                            class="bg-blue-100 text-blue-700 text-xs font-semibold py-1 px-3 rounded-full hover:bg-blue-200 transition disabled:opacity-50 disabled:cursor-not-allowed"
                            disabled
                        >
                            Reset Method Filters
                        </button>
                        <button
                            id="expandAllButton"
                            class="bg-blue-100 text-blue-700 text-xs font-semibold py-1 px-3 rounded-full hover:bg-blue-200 transition disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            Expand All
                        </button>
                        <button
                            id="collapseAllButton"
                            class="bg-blue-100 text-blue-700 text-xs font-semibold py-1 px-3 rounded-full hover:bg-blue-200 transition disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            Collapse All
                        </button>
                    </div>
                </div>

                <div id="results" class="space-y-6"></div>

                <div
                    id="errorBox"
                    class="hidden mt-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg dark:bg-red-900/40 dark:text-red-300 dark:border-red-500"
                    role="alert"
                >
                    <strong class="font-bold">Error:</strong>
                    <span class="block sm:inline" id="errorMessage"></span>
                </div>
            </div>
        </div>

        <footer
            class="text-center py-6 text-sm text-gray-500 dark:text-gray-400"
        >
            <p>Developed in Athens  by MJ with  Google Gemini</p>
        </footer>

        <!-- Help Modal -->
        <div
            id="helpModal"
            class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4"
        >
            <div
                class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-7xl max-h-[90vh] flex flex-col"
            >
                <div
                    class="flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700"
                >
                    <h2
                        class="text-2xl font-bold text-gray-800 dark:text-white font-figtree"
                    >
                        How to Use This Site
                    </h2>
                    <button
                        id="closeHelpModal"
                        class="text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg p-1.5"
                    >
                        <svg
                            class="w-6 h-6"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"
                            ></path>
                        </svg>
                    </button>
                </div>
                <div
                    class="p-6 overflow-y-auto help-modal-content lg:grid lg:grid-cols-2 lg:gap-8"
                >
                    <div class="space-y-6">
                        <div>
                            <h3
                                class="font-semibold text-lg text-gray-800 dark:text-gray-200 mb-2"
                            >
                                What is this site for?
                            </h3>
                            <p class="text-gray-600 dark:text-gray-400">
                                This tool is designed to provide advanced,
                                granular search functionality for the Docebo
                                Learn LMS APIs.
                            </p>
                        </div>
                        <div>
                            <h3
                                class="font-semibold text-lg text-gray-800 dark:text-gray-200 mb-2"
                            >
                                The View Mode Slider
                            </h3>
                            <div
                                class="relative flex items-center rounded-lg bg-gray-200 dark:bg-gray-700 p-1 w-40 my-3 cursor-default"
                            >
                                <div
                                    class="absolute top-1 left-1 h-[calc(100%-0.5rem)] w-[calc(50%-0.25rem)] bg-white dark:bg-gray-600 rounded-md shadow"
                                ></div>
                                <div
                                    class="relative w-1/2 py-1 text-sm font-semibold z-10 text-center text-blue-600 dark:text-blue-400"
                                >
                                    Simple
                                </div>
                                <div
                                    class="relative w-1/2 py-1 text-sm font-semibold z-10 text-center text-gray-600 dark:text-gray-400"
                                >
                                    Detailed
                                </div>
                            </div>
                            <p class="text-gray-600 dark:text-gray-400">
                                The view mode slider controls how much
                                information is displayed for each API endpoint:
                            </p>
                            <ul
                                class="list-disc list-inside text-gray-600 dark:text-gray-400 mt-2 space-y-1"
                            >
                                <li>
                                    <strong>Simple View:</strong> This is the
                                    default view. It shows a compact list of
                                    endpoints with their HTTP method (GET, POST,
                                    etc.), path, and a brief summary. It's fast
                                    and ideal for quickly browsing or searching.
                                </li>
                                <li>
                                    <strong>Detailed View:</strong> This view
                                    allows each endpoint to be expanded to show
                                    comprehensive endpoint details, including
                                    parameters, schemas, and possible API
                                    responses.
                                </li>
                            </ul>
                        </div>
                        <div>
                            <h3
                                class="font-semibold text-lg text-gray-800 dark:text-gray-200 mb-2"
                            >
                                How do the search boxes work?
                            </h3>
                            <p class="text-gray-600 dark:text-gray-400">
                                You can search across four different categories
                                to pinpoint the exact API you're looking for.
                                For each category, you can also check the "Also
                                search description" box to broaden your search.
                            </p>
                            <ul
                                class="list-disc list-inside text-gray-600 dark:text-gray-400 mt-2 space-y-1"
                            >
                                <li>
                                    <strong>Path Name:</strong> Searches the
                                    endpoint's URL path (e.g.,
                                    `/learn/v1/courses`).
                                </li>
                                <li>
                                    <strong>Parameter Name:</strong> Searches
                                    for query or path parameters (e.g.,
                                    `sort_by`, `user_id`). These matches are
                                    highlighted in
                                    <span class="bg-yellow-300/40 px-1 rounded"
                                        >yellow</span
                                    >.
                                </li>
                                <li>
                                    <strong>Request Body Field:</strong>
                                    Searches for field names within the JSON
                                    request body (for POST/PUT requests). These
                                    matches are highlighted in
                                    <span class="bg-pink-500/30 px-1 rounded"
                                        >pink</span
                                    >.
                                </li>
                                <li>
                                    <strong>Response Body Field:</strong>
                                    Searches for field names within the example
                                    JSON response. These matches are highlighted
                                    in
                                    <span class="bg-orange-300/40 px-1 rounded"
                                        >orange</span
                                    >.
                                </li>
                            </ul>
                        </div>
                        <div>
                            <h3
                                class="font-semibold text-lg text-gray-800 dark:text-gray-200 mb-2"
                            >
                                Filtering by Method
                            </h3>
                            <div
                                class="flex flex-wrap gap-2 my-3 cursor-default"
                            >
                                <span
                                    class="px-3 py-1 text-sm font-medium rounded-md text-white bg-blue-600"
                                    >All</span
                                >
                                <span
                                    class="px-3 py-1 text-sm font-medium rounded-md text-white bg-red-600"
                                    >DELETE</span
                                >
                                <span
                                    class="px-3 py-1 text-sm font-medium rounded-md text-white bg-green-600"
                                    >GET</span
                                >
                                <span
                                    class="px-3 py-1 text-sm font-medium rounded-md text-white bg-yellow-500"
                                    >PATCH</span
                                >
                                <span
                                    class="px-3 py-1 text-sm font-medium rounded-md text-white bg-purple-600"
                                    >POST</span
                                >
                                <span
                                    class="px-3 py-1 text-sm font-medium rounded-md text-white bg-orange-500"
                                    >PUT</span
                                >
                            </div>
                            <p class="text-gray-600 dark:text-gray-400">
                                Below each service title (like 'Learn' or
                                'Manage'), you'll find filter buttons for each
                                HTTP method (GET, POST, etc.). Clicking these
                                will show only the endpoints that use that
                                specific method within that service, helping you
                                quickly narrow down the results.
                            </p>
                        </div>
                    </div>
                    <div class="mt-6 lg:mt-0">
                        <h3
                            class="font-semibold text-lg text-gray-800 dark:text-gray-200 mb-2"
                        >
                            Visual Example
                        </h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-3">
                            Here is a non-interactive example of an endpoint
                            with parameters, a request body, and responses in
                            'Detailed' view.
                        </p>
                        <div
                            class="border border-gray-200 dark:border-gray-700 rounded-lg p-4"
                        >
                            <div class="flex items-center justify-between p-3">
                                <div class="flex items-center gap-3 flex-wrap">
                                    <span
                                        class="font-bold text-xs uppercase px-2 py-1 rounded-md text-white text-center w-20 bg-yellow-500"
                                        >PATCH</span
                                    >
                                    <span
                                        class="font-mono text-sm text-gray-800 dark:text-gray-300 break-all"
                                        >/learningplan/v1/learningplans/{id}/additionalfields</span
                                    >
                                </div>
                            </div>
                            <p
                                class="text-gray-600 dark:text-gray-400 text-sm italic px-3 pb-3"
                            >
                                Updates additional fields for a learning plan.
                            </p>
                            <div
                                class="border-t border-gray-200 dark:border-gray-700 p-4 space-y-6"
                            >
                                <h4
                                    class="text-md font-semibold text-gray-700 dark:text-gray-300 mb-2"
                                >
                                    Parameters
                                </h4>
                                <div class="overflow-x-auto">
                                    <table class="w-full text-left">
                                        <thead
                                            class="text-xs text-gray-500 dark:text-gray-400 uppercase"
                                        >
                                            <tr>
                                                <th
                                                    class="p-2 pr-2 font-semibold text-left"
                                                >
                                                    Name
                                                </th>
                                                <th
                                                    class="p-2 pr-2 font-semibold text-left"
                                                >
                                                    In
                                                </th>
                                                <th
                                                    class="p-2 font-semibold text-left"
                                                >
                                                    Description
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr
                                                class="border-b border-gray-200 dark:border-gray-700"
                                            >
                                                <td
                                                    class="p-2 pr-2 font-mono text-sm"
                                                >
                                                    id
                                                    <span class="text-red-500"
                                                        >*</span
                                                    >
                                                </td>
                                                <td
                                                    class="p-2 pr-2 text-sm capitalize text-gray-600 dark:text-gray-400"
                                                >
                                                    path
                                                </td>
                                                <td
                                                    class="p-2 text-sm text-gray-600 dark:text-gray-400"
                                                >
                                                    ID of the learning plan
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <h4
                                    class="text-md font-semibold text-gray-700 dark:text-gray-300 mb-2"
                                >
                                    Request Body
                                </h4>
                                <div
                                    class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700"
                                >
                                    <pre
                                        class="text-white text-sm p-4"
                                    ><code class="language-json">{
  "<span class="text-cyan-400">additional_fields</span>": [
    {
      "<span class="text-cyan-400">field_id</span>": <span class="text-blue-400">123</span>,      <span class="text-gray-500">// (required) The id of the additional field</span>
      "<span class="text-cyan-400">field_value</span>": <span class="text-green-400">"New Value"</span>   <span class="text-gray-500">// (required) The value of the field</span>
    }
  ]
}</code></pre>
                                </div>
                                <h4
                                    class="text-md font-semibold text-gray-700 dark:text-gray-300 mb-2"
                                >
                                    Responses
                                </h4>
                                <table class="w-full text-left">
                                    <tbody>
                                        <tr
                                            class="border-b border-gray-200 dark:border-gray-700"
                                        >
                                            <td
                                                class="py-2 pr-2 font-mono text-sm font-bold text-green-600"
                                            >
                                                200
                                            </td>
                                            <td
                                                class="py-2 text-sm text-gray-600 dark:text-gray-400"
                                            >
                                                OK - Returns the updated fields.
                                            </td>
                                        </tr>
                                        <tr
                                            class="bg-gray-50 dark:bg-gray-900/30"
                                        >
                                            <td colspan="2" class="py-2 px-1">
                                                <div
                                                    class="text-xs text-gray-500 dark:text-gray-400 mb-2 px-1"
                                                >
                                                    Example Response
                                                </div>
                                                <div
                                                    class="code-block-container bg-gray-800 rounded-lg overflow-hidden"
                                                >
                                                    <pre
                                                        class="text-white text-sm p-4"
                                                    ><code>{
  "<span class="text-cyan-400">data</span>": {
    "<span class="text-cyan-400">items</span>": [
      {
        "<span class="text-cyan-400">field_id</span>": <span class="text-blue-400">123</span>,
        "<span class="text-cyan-400">field_value</span>": <span class="text-green-400">"New Value"</span>
      }
    ]
  }
}</code></pre>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr
                                            class="border-b border-gray-200 dark:border-gray-700"
                                        >
                                            <td
                                                class="py-2 pr-2 font-mono text-sm font-bold text-red-600"
                                            >
                                                403
                                            </td>
                                            <td
                                                class="py-2 text-sm text-gray-600 dark:text-gray-400"
                                            >
                                                Forbidden.
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <button
            id="to-top-button"
            title="Go to top"
            class="hidden fixed bottom-8 right-8 bg-blue-600 text-white rounded-full p-3 shadow-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-opacity duration-300"
        >
            <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M5 15l7-7 7 7"
                />
            </svg>
        </button>

        <script>
            // DARK MODE TOGGLE SCRIPT
            const themeToggleBtn = document.getElementById("theme-toggle");
            const themeToggleDarkIcon = document.getElementById(
                "theme-toggle-dark-icon"
            );
            const themeToggleLightIcon = document.getElementById(
                "theme-toggle-light-icon"
            );

            const setTheme = (theme) => {
                if (theme === "dark") {
                    document.documentElement.classList.add("dark");
                    themeToggleLightIcon.classList.remove("hidden");
                    themeToggleDarkIcon.classList.add("hidden");
                    localStorage.setItem("color-theme", "dark");
                } else {
                    document.documentElement.classList.remove("dark");
                    themeToggleDarkIcon.classList.remove("hidden");
                    themeToggleLightIcon.classList.add("hidden");
                    localStorage.setItem("color-theme", "light");
                }
            };

            if (
                localStorage.getItem("color-theme") === "dark" ||
                (!("color-theme" in localStorage) &&
                    window.matchMedia("(prefers-color-scheme: dark)").matches)
            ) {
                setTheme("dark");
            } else {
                setTheme("light");
            }

            themeToggleBtn.addEventListener("click", () => {
                const isDarkMode =
                    document.documentElement.classList.contains("dark");
                setTheme(isDarkMode ? "light" : "dark");
            });
            // --- END OF DARK MODE SCRIPT ---

            const fetchButton = document.getElementById("fetchButton");
            const resultsDiv = document.getElementById("results");
            const baseUrlInput = document.getElementById("baseUrlInput");
            const errorBox = document.getElementById("errorBox");
            const errorMessage = document.getElementById("errorMessage");
            const navContainer = document.getElementById("nav-container");
            const navLinksContainer = document.getElementById("nav-links");
            const toTopButton = document.getElementById("to-top-button");
            const searchContainer = document.getElementById("search-container");
            const searchInput = document.getElementById("searchInput");
            const paramSearchInput =
                document.getElementById("paramSearchInput");
            const bodySearchInput = document.getElementById("bodySearchInput");
            const responseSearchInput = document.getElementById(
                "responseSearchInput"
            );
            const clearSearchInputBtn = document.getElementById(
                "clearSearchInputBtn"
            );
            const clearParamSearchInputBtn = document.getElementById(
                "clearParamSearchInputBtn"
            );
            const clearBodySearchInputBtn = document.getElementById(
                "clearBodySearchInputBtn"
            );
            const clearResponseSearchInputBtn = document.getElementById(
                "clearResponseSearchInputBtn"
            );
            const expandAllButton = document.getElementById("expandAllButton");
            const collapseAllButton =
                document.getElementById("collapseAllButton");
            const expandCollapseContainer = document.getElementById(
                "expand-collapse-container"
            );
            const controlsContainer =
                document.getElementById("controls-container");
            const simpleViewBtn = document.getElementById("simpleViewBtn");
            const detailedViewBtn = document.getElementById("detailedViewBtn");
            const detailedViewWarning = document.getElementById(
                "detailed-view-warning"
            );
            const closeWarningBtn =
                document.getElementById("close-warning-btn");
            const resetFiltersButton =
                document.getElementById("resetFiltersButton");
            const sortAZButton = document.getElementById("sortAZButton");
            const resetSortButton = document.getElementById("resetSortButton");
            const totalApiCountEl = document.getElementById("total-api-count");
            const pathIncludeDescCheck = document.getElementById(
                "pathIncludeDescCheck"
            );
            const paramIncludeDescCheck = document.getElementById(
                "paramIncludeDescCheck"
            );
            const bodyIncludeDescCheck = document.getElementById(
                "bodyIncludeDescCheck"
            );
            const responseIncludeDescCheck = document.getElementById(
                "responseIncludeDescCheck"
            );
            const clearAllButton = document.getElementById("clearAllButton");

            // Sticky Header elements
            const stickyHeader = document.getElementById("sticky-header");
            const stickySearchInput =
                document.getElementById("stickySearchInput");
            const stickyParamSearchInput = document.getElementById(
                "stickyParamSearchInput"
            );
            const stickyBodySearchInput = document.getElementById(
                "stickyBodySearchInput"
            );
            const stickyResponseSearchInput = document.getElementById(
                "stickyResponseSearchInput"
            );
            const stickyClearSearchInputBtn = document.getElementById(
                "stickyClearSearchInputBtn"
            );
            const stickyClearParamSearchInputBtn = document.getElementById(
                "stickyClearParamSearchInputBtn"
            );
            const stickyClearBodySearchInputBtn = document.getElementById(
                "stickyClearBodySearchInputBtn"
            );
            const stickyClearResponseSearchInputBtn = document.getElementById(
                "stickyClearResponseSearchInputBtn"
            );
            const stickySimpleViewBtn = document.getElementById(
                "stickySimpleViewBtn"
            );
            const stickyDetailedViewBtn = document.getElementById(
                "stickyDetailedViewBtn"
            );
            const stickyPathIncludeDescCheck = document.getElementById(
                "stickyPathIncludeDescCheck"
            );
            const stickyParamIncludeDescCheck = document.getElementById(
                "stickyParamIncludeDescCheck"
            );
            const stickyBodyIncludeDescCheck = document.getElementById(
                "stickyBodyIncludeDescCheck"
            );
            const stickyResponseIncludeDescCheck = document.getElementById(
                "stickyResponseIncludeDescCheck"
            );
            const toggleStickySearchBtn = document.getElementById(
                "toggleStickySearchBtn"
            );
            const toggleStickySearchIcon = document.getElementById(
                "toggleStickySearchIcon"
            );
            const stickySearchArea =
                document.getElementById("stickySearchArea");

            // Help Modal Elements
            const helpButton = document.getElementById("helpButton");
            const helpModal = document.getElementById("helpModal");
            const closeHelpModal = document.getElementById("closeHelpModal");

            let allServiceDetails = [];
            let originalServiceDetails = [];
            let isDetailedView = false;
            let activeMethodFilters = {};
            let currentSortState = "original";

            closeWarningBtn.addEventListener("click", () => {
                sessionStorage.setItem("warningClosed", "true");
                detailedViewWarning.classList.add("hidden");
            });

            helpButton.addEventListener("click", () =>
                helpModal.classList.remove("hidden")
            );
            closeHelpModal.addEventListener("click", () =>
                helpModal.classList.add("hidden")
            );
            helpModal.addEventListener("click", (e) => {
                if (e.target === helpModal) {
                    helpModal.classList.add("hidden");
                }
            });

            fetchButton.addEventListener("click", async () => {
                if (isDetailedView) {
                    setView(false, true);
                }

                const baseUrl = baseUrlInput.value.trim();
                if (!baseUrl) {
                    showError("Please enter a valid Docebo base URL.");
                    return;
                }

                resultsDiv.innerHTML =
                    '<div class="flex justify-center p-10"><div class="spinner"></div></div>';
                navContainer.classList.add("hidden");
                searchContainer.classList.add("hidden");
                expandCollapseContainer.classList.add("hidden");
                controlsContainer.classList.add("hidden");
                detailedViewWarning.classList.add("hidden");
                stickyHeader.classList.add("hidden", "-translate-y-full");

                // Manually clear inputs to prevent re-render that hides the spinner
                searchInput.value = "";
                paramSearchInput.value = "";
                bodySearchInput.value = "";
                responseSearchInput.value = "";
                stickySearchInput.value = "";
                stickyParamSearchInput.value = "";
                stickyBodySearchInput.value = "";
                stickyResponseSearchInput.value = "";
                pathIncludeDescCheck.checked = false;
                paramIncludeDescCheck.checked = false;
                bodyIncludeDescCheck.checked = false;
                responseIncludeDescCheck.checked = false;
                stickyPathIncludeDescCheck.checked = false;
                stickyParamIncludeDescCheck.checked = false;
                stickyBodyIncludeDescCheck.checked = false;
                stickyResponseIncludeDescCheck.checked = false;
                updateClearAllButtonState();
                clearSearchInputBtn.classList.add("hidden");
                stickyClearSearchInputBtn.classList.add("hidden");
                clearParamSearchInputBtn.classList.add("hidden");
                stickyClearParamSearchInputBtn.classList.add("hidden");
                clearBodySearchInputBtn.classList.add("hidden");
                stickyClearBodySearchInputBtn.classList.add("hidden");
                clearResponseSearchInputBtn.classList.add("hidden");
                stickyClearResponseSearchInputBtn.classList.add("hidden");

                navLinksContainer.innerHTML = "";
                activeMethodFilters = {};
                fetchButton.disabled = true;
                fetchButton.classList.add("opacity-50", "cursor-not-allowed");
                updateResetButtonState();
                hideError();

                const corsProxy = "https://corsproxy.io/?";
                const servicesUrl = `${corsProxy}${encodeURIComponent(
                    `https://${baseUrl}/manage/v1/site/microservices`
                )}`;

                try {
                    const response = await fetch(servicesUrl);
                    if (!response.ok)
                        throw new Error(
                            `Failed to fetch services list. Status: ${response.status}`
                        );
                    const servicesData = await response.json();

                    if (!servicesData.data || servicesData.data.length === 0) {
                        showError("No microservices found at this URL.");
                        resultsDiv.innerHTML = "";
                        return;
                    }

                    const swaggerPromises = servicesData.data.map((service) =>
                        fetch(`${corsProxy}${encodeURIComponent(service.url)}`)
                            .then((res) => (res.ok ? res.json() : null))
                            .then((swaggerJson) => ({ service, swaggerJson }))
                            .catch((err) => {
                                console.error(
                                    `Error processing ${service.app}:`,
                                    err
                                );
                                return { service, swaggerJson: null };
                            })
                    );

                    allServiceDetails = await Promise.all(swaggerPromises);
                    originalServiceDetails = [...allServiceDetails];
                    currentSortState = "original";
                    updateSortButtonsState();
                    renderServices(allServiceDetails);
                } catch (error) {
                    console.error("An error occurred:", error);
                    showError(error.message || "An unknown error occurred.");
                    resultsDiv.innerHTML = "";
                } finally {
                    fetchButton.disabled = false;
                    fetchButton.classList.remove(
                        "opacity-50",
                        "cursor-not-allowed"
                    );
                }
            });

            function renderServices(
                serviceDetailsToRender,
                expansionStates = {}
            ) {
                resultsDiv.innerHTML = "";
                navLinksContainer.innerHTML = "";

                const paramSearchTerm = paramSearchInput.value
                    .toLowerCase()
                    .trim();
                const includeParamDesc = paramIncludeDescCheck.checked;
                const bodySearchTerm = bodySearchInput.value
                    .toLowerCase()
                    .trim();
                const includeBodyDesc = bodyIncludeDescCheck.checked;
                const responseSearchTerm = responseSearchInput.value
                    .toLowerCase()
                    .trim();
                const includeResponseDesc = responseIncludeDescCheck.checked;
                const hasAnyServices = allServiceDetails.some(
                    (d) =>
                        d.swaggerJson &&
                        Object.keys(d.swaggerJson.paths || {}).length > 0
                );
                const validServices = serviceDetailsToRender.filter(
                    (d) =>
                        d.swaggerJson &&
                        Object.keys(d.swaggerJson.paths || {}).length > 0
                );

                if (hasAnyServices) {
                    controlsContainer.classList.remove("hidden");
                    controlsContainer.classList.add("flex");
                    if (sessionStorage.getItem("warningClosed") !== "true") {
                        detailedViewWarning.classList.remove("hidden");
                    }
                    navContainer.classList.remove("hidden");
                    searchContainer.classList.remove("hidden");
                    stickyHeader.classList.remove("hidden");

                    validServices.forEach(({ service }) => {
                        const serviceId = `service-${service.app}`;
                        navLinksContainer.innerHTML += `<a href="#${serviceId}" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-lg transition capitalize dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-300">${service.app}</a>`;
                    });
                } else {
                    stickyHeader.classList.add("hidden");
                    controlsContainer.classList.add("hidden");
                    controlsContainer.classList.remove("flex");
                    searchContainer.classList.add("hidden");
                    detailedViewWarning.classList.add("hidden");
                }

                if (validServices.length === 0) {
                    if (
                        searchInput.value ||
                        paramSearchInput.value ||
                        bodySearchInput.value ||
                        responseSearchInput.value
                    ) {
                        resultsDiv.innerHTML =
                            '<p class="text-center text-gray-600 dark:text-gray-400">No API endpoints match your search criteria.</p>';
                    }
                    updateExpandCollapseButtonsState();
                    updateTotalCount();
                    return;
                }

                validServices.forEach(({ service, swaggerJson }) => {
                    const serviceId = `service-${service.app}`;
                    const card = document.createElement("div");
                    card.className =
                        "service-card bg-gray-50 border border-gray-200 rounded-xl p-6 scroll-mt-20 md:scroll-mt-40 dark:bg-gray-800/[.5] dark:border-gray-700";
                    card.id = serviceId;

                    let apiCount = 0;
                    let endpointsHtml = "";
                    const uniqueMethods = new Set();

                    const groupedEndpoints = {};
                    for (const path in swaggerJson.paths) {
                        for (const method in swaggerJson.paths[path]) {
                            const endpointInfo =
                                swaggerJson.paths[path][method];
                            uniqueMethods.add(method.toUpperCase());
                            if (
                                endpointInfo &&
                                Array.isArray(endpointInfo.tags) &&
                                endpointInfo.tags.length > 0
                            ) {
                                const tag = endpointInfo.tags[0];
                                if (!groupedEndpoints[tag])
                                    groupedEndpoints[tag] = [];
                                groupedEndpoints[tag].push({
                                    path,
                                    method: method.toUpperCase(),
                                    ...endpointInfo,
                                });
                            }
                        }
                    }

                    const sortedGroupNames =
                        Object.keys(groupedEndpoints).sort();
                    apiCount = Object.values(groupedEndpoints).reduce(
                        (sum, group) => sum + group.length,
                        0
                    );

                    if (apiCount > 0) {
                        endpointsHtml = sortedGroupNames
                            .map((groupName) => {
                                groupedEndpoints[groupName].sort((a, b) =>
                                    a.path.localeCompare(b.path)
                                );
                                const pathList = groupedEndpoints[groupName]
                                    .map((endpoint) => {
                                        const methodColor = getMethodColor(
                                            endpoint.method
                                        );

                                        let detailsHtml = "";
                                        let chevronHtml = "";
                                        let cursorClass = "";

                                        if (isDetailedView) {
                                            const parametersHtml =
                                                buildParametersHtml(
                                                    endpoint.parameters,
                                                    swaggerJson,
                                                    paramSearchTerm,
                                                    bodySearchTerm,
                                                    includeParamDesc,
                                                    includeBodyDesc
                                                );
                                            const responsesHtml =
                                                buildResponsesHtml(
                                                    endpoint.responses,
                                                    swaggerJson,
                                                    responseSearchTerm,
                                                    includeResponseDesc
                                                );
                                            detailsHtml = `
                                <div class="endpoint-details border-t border-gray-200 dark:border-gray-700">
                                    <div class="p-4 space-y-6">
                                        ${parametersHtml}
                                        ${responsesHtml}
                                    </div>
                                </div>`;
                                            chevronHtml = `<svg class="endpoint-chevron w-5 h-5 text-gray-500 dark:text-gray-400 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>`;
                                            cursorClass = "cursor-pointer";
                                        }

                                        return `
                            <li class="endpoint-item bg-gray-100 dark:bg-gray-900/50 rounded-lg" data-method="${
                                endpoint.method
                            }">
                                <div class="endpoint-header flex items-center justify-between p-3 ${cursorClass}">
                                    <div class="flex items-center gap-3 flex-wrap">
                                        <span class="font-bold text-xs uppercase px-2 py-1 rounded-md text-white text-center w-20 ${methodColor}">${
                                            endpoint.method
                                        }</span>
                                        <span class="font-mono text-sm text-gray-800 dark:text-gray-300 break-all">${
                                            endpoint.path
                                        }</span>
                                    </div>
                                    ${chevronHtml}
                                </div>
                                <p class="text-gray-600 dark:text-gray-400 text-sm italic px-3 pb-3">${
                                    endpoint.summary ||
                                    "No description provided."
                                }</p>
                                ${detailsHtml}
                            </li>`;
                                    })
                                    .join("");
                                return `<div class="subsection-container mt-6">
                            <h3 class="text-xl font-semibold text-gray-700 dark:text-gray-300">${groupName}</h3>
                            <ul class="space-y-2 mt-2 list-none pl-0">${pathList}</ul>
                        </div>`;
                            })
                            .join("");
                    } else {
                        endpointsHtml =
                            '<p class="text-gray-500 dark:text-gray-400 mt-4">No endpoints found for this service.</p>';
                    }

                    const currentFilter =
                        activeMethodFilters[serviceId] || "All";

                    const methodFilterButtons = [
                        "All",
                        ...Array.from(uniqueMethods).sort(),
                    ]
                        .map((method) => {
                            const isActive = method === currentFilter;
                            let finalClasses = "";
                            if (isActive) {
                                if (method === "All") {
                                    finalClasses = "bg-blue-600 text-white";
                                } else {
                                    finalClasses = `${getMethodColor(
                                        method
                                    )} text-white`;
                                }
                            } else {
                                finalClasses =
                                    "bg-gray-200 hover:bg-gray-300 text-gray-800 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-300";
                            }
                            return `<button class="method-filter-btn px-3 py-1 text-sm font-medium rounded-md transition ${finalClasses}" data-filter-method="${method}">${method}</button>`;
                        })
                        .join("");

                    const isExpanded = expansionStates[serviceId] !== false;

                    card.innerHTML = `
                    <div class="card-header flex justify-between items-center cursor-pointer">
                        <div>
                            <h2 class="text-3xl font-bold capitalize text-gray-800 font-figtree dark:text-gray-100">${
                                service.app
                            }</h2>
                            <p class="api-count text-md text-gray-600 dark:text-gray-400 mt-1">${apiCount} API Endpoints</p>
                        </div>
                        <svg class="collapse-icon w-6 h-6 text-gray-500 dark:text-gray-400 transition-transform duration-300 ${
                            isExpanded ? "" : "rotate-180"
                        }" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </div>
                    <div class="collapsible-content ${
                        isExpanded ? "expanded" : ""
                    }">
                        <div>
                            <div class="method-filter-controls flex flex-wrap gap-2 border-b border-gray-200 dark:border-gray-700 pt-4 pb-4">${methodFilterButtons}</div>
                            <div class="endpoints-list mt-2">${endpointsHtml}</div>
                        </div>
                    </div>`;
                    resultsDiv.appendChild(card);
                });

                addMethodFiltering();
                addCollapseFunctionality();
                if (isDetailedView) {
                    addEndpointExpansion();
                    addCopyFunctionality();
                    addCommentToggleFunctionality();
                    addWordWrapToggleFunctionality();
                }
                updateExpandCollapseButtonsState();
                updateResetButtonState();
                updateTotalCount();

                document.querySelectorAll(".service-card").forEach((card) => {
                    const serviceId = card.id;
                    const filter = activeMethodFilters[serviceId] || "All";
                    if (filter !== "All") {
                        applyMethodFilterToCard(card, filter);
                    }
                });
            }

            function buildParametersHtml(
                parameters,
                swaggerJson,
                paramSearchTerm = "",
                bodySearchTerm = "",
                includeParamDesc = false,
                includeBodyDesc = false
            ) {
                if (!parameters || parameters.length === 0) return "";
                let html =
                    '<h4 class="text-md font-semibold text-gray-700 dark:text-gray-300 mb-2">Parameters</h4>';
                let contentHtml = "";

                const bodyParam = parameters.find((p) => p.in === "body");
                const otherParams = parameters.filter((p) => p.in !== "body");

                if (otherParams.length > 0) {
                    const paramsList = otherParams
                        .map((p) => {
                            let isHighlighted = false;
                            if (paramSearchTerm) {
                                const nameMatch = p.name
                                    .toLowerCase()
                                    .includes(paramSearchTerm);
                                if (includeParamDesc) {
                                    const descMatch = p.description
                                        ? p.description
                                              .toLowerCase()
                                              .includes(paramSearchTerm)
                                        : false;
                                    isHighlighted = nameMatch || descMatch;
                                } else {
                                    isHighlighted = nameMatch;
                                }
                            }
                            const highlightClass = isHighlighted
                                ? "bg-yellow-200 dark:bg-yellow-800/50"
                                : "";

                            return `
                    <tr class="border-b border-gray-200 dark:border-gray-700 ${highlightClass}">
                        <td class="p-2 pr-2 font-mono text-sm">${
                            p.name
                        } <span class="text-red-500">${
                                p.required ? "*" : ""
                            }</span></td>
                        <td class="p-2 pr-2 text-sm capitalize text-gray-600 dark:text-gray-400">${
                            p.in
                        }</td>
                        <td class="p-2 text-sm text-gray-600 dark:text-gray-400">${
                            p.description || ""
                        }</td>
                    </tr>
                `;
                        })
                        .join("");

                    contentHtml += `
                    <div class="overflow-x-auto">
                        <table class="param-table">
                            <colgroup>
                                <col class="w-1/4">
                                <col class="w-1/6">
                                <col>
                            </colgroup>
                            <thead class="text-xs text-gray-500 dark:text-gray-400 uppercase">
                                <tr><th class="p-2 pr-2 font-semibold text-left">Name</th><th class="p-2 pr-2 font-semibold text-left">In</th><th class="p-2 font-semibold text-left">Description</th></tr>
                            </thead>
                            <tbody>${paramsList}</tbody>
                        </table>
                    </div>
                `;
                }

                if (bodyParam && bodyParam.schema) {
                    const exampleNoComments = generateExampleWithComments(
                        bodyParam.schema,
                        swaggerJson,
                        "none"
                    );

                    const highlightedAll = generateRichExampleWithComments(
                        bodyParam.schema,
                        swaggerJson,
                        "all",
                        bodySearchTerm,
                        "highlight-body-field",
                        includeBodyDesc
                    );
                    const highlightedPrimitive =
                        generateRichExampleWithComments(
                            bodyParam.schema,
                            swaggerJson,
                            "primitive",
                            bodySearchTerm,
                            "highlight-body-field",
                            includeBodyDesc
                        );
                    const highlightedNone = generateRichExampleWithComments(
                        bodyParam.schema,
                        swaggerJson,
                        "none",
                        bodySearchTerm,
                        "highlight-body-field",
                        includeBodyDesc
                    );

                    const lines = highlightedAll.split("\n");
                    let finalCodeHtml = "";
                    for (let i = 0; i < lines.length; i++) {
                        finalCodeHtml += `<div class="code-line"><span class="line-number">${
                            i + 1
                        }</span><span class="line-content">${
                            lines[i]
                        }</span></div>`;
                    }

                    contentHtml += `
                    <h4 class="text-md font-semibold text-gray-700 dark:text-gray-300 mt-4 mb-2">Request Body</h4>
                    <div class="code-block-container bg-gray-800 rounded-lg overflow-hidden">
                        <div class="bg-gray-700/50 p-2 flex justify-end items-center gap-2">
                             <button title="Toggle Word Wrap" class="toggle-wrap-btn py-1 px-2 bg-gray-600 rounded-md hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-400 transition flex items-center" data-wrapped="false">
                                <span class="text-xs font-semibold text-gray-300">Wrap: off</span>
                             </button>
                             <button title="Toggle Comments" class="toggle-comments-btn py-1 px-2 bg-gray-600 rounded-md hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-400 transition flex items-center" data-comment-state="all">
                                <span class="text-xs font-semibold text-gray-300">Comments: Full</span>
                             </button>
                            <button title="Copy to clipboard" class="copy-btn p-1.5 bg-gray-600 rounded-md hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-400 transition flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
                            </button>
                        </div>
                        <pre class="text-white text-sm p-4 max-h-[500px] overflow-auto no-wrap"><code 
                            data-state-all="${encodeURIComponent(
                                highlightedAll
                            )}"
                            data-state-primitive="${encodeURIComponent(
                                highlightedPrimitive
                            )}"
                            data-state-none="${encodeURIComponent(
                                highlightedNone
                            )}"
                            data-plain-text="${encodeURIComponent(
                                exampleNoComments
                            )}"
                        >${finalCodeHtml}</code></pre>
                    </div>
                `;
                }

                return html + contentHtml;
            }

            function getResponseCodeColor(code) {
                const numericCode = parseInt(code, 10);
                if (numericCode >= 200 && numericCode < 300)
                    return "text-green-600";
                if (numericCode >= 300 && numericCode < 400)
                    return "text-yellow-600";
                if (numericCode >= 400 && numericCode < 600)
                    return "text-red-600";
                return "text-gray-600 dark:text-gray-400";
            }

            function buildResponsesHtml(
                responses,
                swaggerJson,
                responseSearchTerm = "",
                includeResponseDesc = false
            ) {
                if (!responses || Object.keys(responses).length === 0)
                    return "";
                const responsesList = Object.entries(responses)
                    .map(([code, resp]) => {
                        const colorClass = getResponseCodeColor(code);
                        let schemaHtml = "";
                        if (resp.schema) {
                            const exampleNoComments =
                                generateExampleWithComments(
                                    resp.schema,
                                    swaggerJson,
                                    "none"
                                );

                            const highlightedAll =
                                generateRichExampleWithComments(
                                    resp.schema,
                                    swaggerJson,
                                    "all",
                                    responseSearchTerm,
                                    "highlight-response-field",
                                    includeResponseDesc
                                );
                            const highlightedPrimitive =
                                generateRichExampleWithComments(
                                    resp.schema,
                                    swaggerJson,
                                    "primitive",
                                    responseSearchTerm,
                                    "highlight-response-field",
                                    includeResponseDesc
                                );
                            const highlightedNone =
                                generateRichExampleWithComments(
                                    resp.schema,
                                    swaggerJson,
                                    "none",
                                    responseSearchTerm,
                                    "highlight-response-field",
                                    includeResponseDesc
                                );

                            const lines = highlightedAll.split("\n");
                            let finalCodeHtml = "";
                            for (let i = 0; i < lines.length; i++) {
                                finalCodeHtml += `<div class="code-line"><span class="line-number">${
                                    i + 1
                                }</span><span class="line-content">${
                                    lines[i]
                                }</span></div>`;
                            }

                            if (exampleNoComments) {
                                schemaHtml = `
                            <tr class="bg-gray-50 dark:bg-gray-900/30">
                                <td colspan="2" class="py-2 px-1">
                                    <details>
                                        <summary class="text-xs text-gray-500 dark:text-gray-400 cursor-pointer">Example Response</summary>
                                        <div class="code-block-container bg-gray-800 rounded-lg overflow-hidden mt-2">
                                            <div class="bg-gray-700/50 p-2 flex justify-end items-center gap-2">
                                                <button title="Toggle Word Wrap" class="toggle-wrap-btn py-1 px-2 bg-gray-600 rounded-md hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-400 transition flex items-center" data-wrapped="false">
                                                    <span class="text-xs font-semibold text-gray-300">Wrap: off</span>
                                                 </button>
                                                 <button title="Toggle Comments" class="toggle-comments-btn py-1 px-2 bg-gray-600 rounded-md hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-400 transition flex items-center" data-comment-state="all">
                                                    <span class="text-xs font-semibold text-gray-300">Comments: Full</span>
                                                 </button>
                                                <button title="Copy to clipboard" class="copy-btn p-1.5 bg-gray-600 rounded-md hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-400 transition flex items-center">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
                                                </button>
                                            </div>
                                            <pre class="text-white text-sm p-4 max-h-[500px] overflow-auto no-wrap"><code
                                                data-state-all="${encodeURIComponent(
                                                    highlightedAll
                                                )}"
                                                data-state-primitive="${encodeURIComponent(
                                                    highlightedPrimitive
                                                )}"
                                                data-state-none="${encodeURIComponent(
                                                    highlightedNone
                                                )}"
                                                data-plain-text="${encodeURIComponent(
                                                    exampleNoComments
                                                )}"
                                            >${finalCodeHtml}</code></pre>
                                        </div>
                                    </details>
                                </td>
                            </tr>
                        `;
                            }
                        }
                        return `
                    <tr class="border-b border-gray-200 dark:border-gray-700">
                        <td class="py-2 pr-2 font-mono text-sm font-bold ${colorClass}">${code}</td>
                        <td class="py-2 text-sm text-gray-600 dark:text-gray-400">${
                            resp.description || ""
                        }</td>
                    </tr>
                    ${schemaHtml}
                `;
                    })
                    .join("");

                return `
                <h4 class="text-md font-semibold text-gray-700 dark:text-gray-300 mb-2">Responses</h4>
                <div class="overflow-x-auto">
                    <table class="w-full text-left param-table">
                         <colgroup>
                            <col class="w-1/6">
                            <col>
                        </colgroup>
                        <thead class="text-xs text-gray-500 dark:text-gray-400 uppercase">
                            <tr><th class="py-2 pr-2 font-semibold">Code</th><th class="py-2 pr-2 font-semibold">Description</th></tr>
                        </thead>
                        <tbody>${responsesList}</tbody>
                    </table>
                </div>
            `;
            }

            function addCopyFunctionality() {
                const copyIconSvg = `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>`;
                const copiedIconSvg = `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>`;

                document.querySelectorAll(".copy-btn").forEach((button) => {
                    button.addEventListener("click", () => {
                        const container = button.closest(
                            ".code-block-container"
                        );
                        const code = container.querySelector("code");
                        let textToCopy = code.dataset.plainText
                            ? decodeURIComponent(code.dataset.plainText)
                            : code.innerText;

                        const textArea = document.createElement("textarea");
                        textArea.value = textToCopy;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand("copy");
                        document.body.removeChild(textArea);

                        button.innerHTML = copiedIconSvg;
                        setTimeout(() => {
                            button.innerHTML = copyIconSvg;
                        }, 2000);
                    });
                });
            }

            function addCommentToggleFunctionality() {
                document
                    .querySelectorAll(".toggle-comments-btn")
                    .forEach((button) => {
                        button.addEventListener("click", () => {
                            const codeContainer = button.closest(
                                ".code-block-container"
                            );
                            if (!codeContainer) return;

                            const codeEl = codeContainer.querySelector("code");
                            const currentState = button.dataset.commentState;
                            let nextState;
                            let nextText;

                            if (currentState === "all") {
                                nextState = "primitive";
                                nextText = "Comments: Limited";
                            } else if (currentState === "primitive") {
                                nextState = "none";
                                nextText = "Comments: Off";
                            } else {
                                // 'none'
                                nextState = "all";
                                nextText = "Comments: Full";
                            }

                            button.dataset.commentState = nextState;
                            button.querySelector("span").textContent = nextText;

                            const stateKey =
                                "state" +
                                nextState.charAt(0).toUpperCase() +
                                nextState.slice(1);
                            const newHtml = decodeURIComponent(
                                codeEl.dataset[stateKey]
                            );

                            // Rebuild the line-numbered HTML
                            const lines = newHtml.split("\n");
                            let finalCodeHtml = "";
                            for (let i = 0; i < lines.length; i++) {
                                finalCodeHtml += `<div class="code-line"><span class="line-number">${
                                    i + 1
                                }</span><span class="line-content">${
                                    lines[i]
                                }</span></div>`;
                            }
                            codeEl.innerHTML = finalCodeHtml;
                        });
                    });
            }

            function addWordWrapToggleFunctionality() {
                document
                    .querySelectorAll(".toggle-wrap-btn")
                    .forEach((button) => {
                        button.addEventListener("click", () => {
                            const pre = button
                                .closest(".code-block-container")
                                .querySelector("pre");
                            if (!pre) return;

                            const isWrapped = button.dataset.wrapped === "true";
                            const nextWrapState = !isWrapped;

                            pre.classList.toggle("no-wrap", !nextWrapState);
                            pre.classList.toggle("word-wrap", nextWrapState);

                            button.dataset.wrapped = nextWrapState;
                            button.querySelector("span").textContent = `Wrap: ${
                                nextWrapState ? "on" : "off"
                            }`;
                        });
                    });
            }

            function resolveRef(ref, swaggerJson) {
                if (!ref || !ref.startsWith("#/")) return null;
                const parts = ref.substring(2).split("/");
                let current = swaggerJson;
                for (const part of parts) {
                    if (current && part in current) {
                        current = current[part];
                    } else {
                        return null;
                    }
                }
                return current;
            }

            function generateExampleWithComments(
                schema,
                swaggerJson,
                commentMode = "all"
            ) {
                // Helper to get a primitive value example as a string
                function getPrimitiveExample(s) {
                    if (s.enum && s.enum.length > 0)
                        return JSON.stringify(s.enum[0]);
                    switch (s.type) {
                        case "string":
                            return '"string"';
                        case "integer":
                        case "number":
                            return "0";
                        case "boolean":
                            return "true";
                        default:
                            return "{}";
                    }
                }

                // Main recursive function to build the formatted string
                function _generate(
                    currentSchema,
                    indentLevel,
                    visitedRefs = new Set(),
                    comment = ""
                ) {
                    if (!currentSchema) return "{}";

                    // Handle schema references
                    if (currentSchema.$ref) {
                        if (visitedRefs.has(currentSchema.$ref))
                            return '"/* Circular Reference */"';
                        visitedRefs.add(currentSchema.$ref);
                        const resolved = resolveRef(
                            currentSchema.$ref,
                            swaggerJson
                        );
                        const result = _generate(
                            resolved,
                            indentLevel,
                            visitedRefs,
                            comment
                        );
                        visitedRefs.delete(currentSchema.$ref);
                        return result;
                    }

                    // Utility to decode HTML entities from descriptions
                    const decodeHtmlEntities = (text) => {
                        if (!text || typeof document === "undefined")
                            return text;
                        const textArea = document.createElement("textarea");
                        textArea.innerHTML = text;
                        return textArea.value;
                    };

                    const indent = "  ".repeat(indentLevel);
                    const childIndent = "  ".repeat(indentLevel + 1);
                    // Infer type if missing, which is valid for objects with properties
                    const schemaType =
                        currentSchema.type ||
                        (currentSchema.properties ? "object" : undefined);

                    const description = currentSchema.description || "";
                    const lowerDesc = description.toLowerCase();
                    const dateTimeRegex = /\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}/;
                    const dateRegex = /\d{4}-\d{2}-\d{2}/;

                    if (schemaType === "string") {
                        if (
                            lowerDesc.includes("yyyy-mm-dd hh:mm:ss") ||
                            dateTimeRegex.test(description) ||
                            currentSchema.format === "date-time"
                        ) {
                            return '"2025-09-12 12:00:00"';
                        } else if (
                            lowerDesc.includes("yyyy-mm-dd") ||
                            dateRegex.test(description) ||
                            currentSchema.format === "date"
                        ) {
                            return '"2025-09-12"';
                        }
                    }

                    switch (schemaType) {
                        case "object":
                            const properties = currentSchema.properties;
                            if (
                                !properties ||
                                Object.keys(properties).length === 0
                            )
                                return `{${comment}}`;

                            const requiredFields = new Set(
                                currentSchema.required || []
                            );
                            const keys = Object.keys(properties);

                            const lines = keys.map((key, index) => {
                                const propSchema = properties[key];
                                const propType =
                                    propSchema.type ||
                                    (propSchema.properties
                                        ? "object"
                                        : "object");
                                const isLast = index === keys.length - 1;

                                let showComment = false;
                                if (commentMode === "all") {
                                    showComment = true;
                                } else if (
                                    commentMode === "primitive" &&
                                    propType !== "object" &&
                                    propType !== "array"
                                ) {
                                    showComment = true;
                                }

                                const isRequired = requiredFields.has(key)
                                    ? "(required)"
                                    : "(optional)";
                                let description = propSchema.description
                                    ? decodeHtmlEntities(propSchema.description)
                                          .replace(/\s+/g, " ")
                                          .trim()
                                    : "";

                                if (
                                    propSchema.enum &&
                                    Array.isArray(propSchema.enum) &&
                                    propSchema.enum.length > 0
                                ) {
                                    let enumString = "Can be ";
                                    if (propSchema.enum.length === 1) {
                                        enumString += `${propSchema.enum[0]}.`;
                                    } else if (propSchema.enum.length === 2) {
                                        enumString += `${propSchema.enum.join(
                                            " or "
                                        )}.`;
                                    } else {
                                        const last =
                                            propSchema.enum[
                                                propSchema.enum.length - 1
                                            ];
                                        const initial = propSchema.enum.slice(
                                            0,
                                            -1
                                        );
                                        enumString +=
                                            initial.join(", ") +
                                            `, or ${last}.`;
                                    }
                                    description += ` ${enumString}`;
                                }

                                const propComment =
                                    showComment && description
                                        ? `      // ${isRequired} ${description}`
                                        : "";

                                let valueString;
                                if (
                                    propType === "object" ||
                                    propType === "array"
                                ) {
                                    valueString = _generate(
                                        propSchema,
                                        indentLevel + 1,
                                        visitedRefs,
                                        propComment
                                    );
                                } else {
                                    valueString = _generate(
                                        propSchema,
                                        indentLevel + 1,
                                        visitedRefs
                                    );
                                }

                                let line = `${childIndent}"${key}": ${valueString}`;

                                if (!isLast) {
                                    line += ",";
                                }

                                if (
                                    propType !== "object" &&
                                    propType !== "array" &&
                                    propComment
                                ) {
                                    line += propComment;
                                }

                                return line;
                            });

                            return `{${comment}\n${lines.join(
                                "\n"
                            )}\n${indent}}`;

                        case "array":
                            if (currentSchema.items) {
                                const itemExample = _generate(
                                    currentSchema.items,
                                    indentLevel + 1,
                                    visitedRefs
                                );
                                return `[${comment}\n${childIndent}${itemExample}\n${indent}]`;
                            }
                            return `[]${comment}`;

                        default:
                            return getPrimitiveExample(currentSchema);
                    }
                }

                return _generate(schema, 0);
            }

            function generateRichExampleWithComments(
                schema,
                swaggerJson,
                commentMode = "all",
                searchTerm = "",
                highlightClass = "",
                includeDesc = false
            ) {
                // Helper for primitive value highlighting
                function getPrimitiveExampleHtml(s) {
                    if (s.enum && s.enum.length > 0)
                        return `<span class="text-green-400">${JSON.stringify(
                            s.enum[0]
                        )}</span>`;
                    switch (s.type) {
                        case "string":
                            return `<span class="text-green-400">"string"</span>`;
                        case "integer":
                        case "number":
                            return `<span class="text-blue-400">0</span>`;
                        case "boolean":
                            return `<span class="text-purple-400">true</span>`;
                        default:
                            return "{}";
                    }
                }

                // Main recursive function to build the formatted string
                function _generate(
                    currentSchema,
                    indentLevel,
                    visitedRefs = new Set(),
                    comment = ""
                ) {
                    if (!currentSchema) return "{}";

                    // Handle schema references
                    if (currentSchema.$ref) {
                        if (visitedRefs.has(currentSchema.$ref))
                            return '"/* Circular Reference */"';
                        visitedRefs.add(currentSchema.$ref);
                        const resolved = resolveRef(
                            currentSchema.$ref,
                            swaggerJson
                        );
                        const result = _generate(
                            resolved,
                            indentLevel,
                            visitedRefs,
                            comment
                        );
                        visitedRefs.delete(currentSchema.$ref);
                        return result;
                    }

                    // Utility to decode HTML entities from descriptions
                    const decodeHtmlEntities = (text) => {
                        if (!text || typeof document === "undefined")
                            return text;
                        const textArea = document.createElement("textarea");
                        textArea.innerHTML = text;
                        return textArea.value;
                    };

                    const indent = "  ".repeat(indentLevel);
                    const childIndent = "  ".repeat(indentLevel + 1);
                    const schemaType =
                        currentSchema.type ||
                        (currentSchema.properties ? "object" : undefined);

                    const description = currentSchema.description || "";
                    const lowerDesc = description.toLowerCase();
                    const dateTimeRegex = /\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}/;
                    const dateRegex = /\d{4}-\d{2}-\d{2}/;

                    if (schemaType === "string") {
                        if (
                            lowerDesc.includes("yyyy-mm-dd hh:mm:ss") ||
                            dateTimeRegex.test(description) ||
                            currentSchema.format === "date-time"
                        ) {
                            return '<span class="text-green-400">"2025-09-12 12:00:00"</span>';
                        } else if (
                            lowerDesc.includes("yyyy-mm-dd") ||
                            dateRegex.test(description) ||
                            currentSchema.format === "date"
                        ) {
                            return '<span class="text-green-400">"2025-09-12"</span>';
                        }
                    }

                    switch (schemaType) {
                        case "object":
                            const properties = currentSchema.properties;
                            if (
                                !properties ||
                                Object.keys(properties).length === 0
                            )
                                return `{${comment}}`;

                            const requiredFields = new Set(
                                currentSchema.required || []
                            );
                            const keys = Object.keys(properties);

                            const lines = keys.map((key, index) => {
                                const propSchema = properties[key];
                                const propType =
                                    propSchema.type ||
                                    (propSchema.properties
                                        ? "object"
                                        : "object");
                                const isLast = index === keys.length - 1;

                                let description = propSchema.description
                                    ? decodeHtmlEntities(propSchema.description)
                                          .replace(/\s+/g, " ")
                                          .trim()
                                    : "";

                                if (
                                    propSchema.enum &&
                                    Array.isArray(propSchema.enum) &&
                                    propSchema.enum.length > 0
                                ) {
                                    let enumString = "Can be ";
                                    if (propSchema.enum.length === 1) {
                                        enumString += `${propSchema.enum[0]}.`;
                                    } else if (propSchema.enum.length === 2) {
                                        enumString += `${propSchema.enum.join(
                                            " or "
                                        )}.`;
                                    } else {
                                        const last =
                                            propSchema.enum[
                                                propSchema.enum.length - 1
                                            ];
                                        const initial = propSchema.enum.slice(
                                            0,
                                            -1
                                        );
                                        enumString +=
                                            initial.join(", ") +
                                            `, or ${last}.`;
                                    }
                                    description += ` ${enumString}`;
                                }

                                const isHighlighted =
                                    searchTerm &&
                                    (key.toLowerCase().includes(searchTerm) ||
                                        (includeDesc &&
                                            description &&
                                            description
                                                .toLowerCase()
                                                .includes(searchTerm)));

                                let keyHtml = `<span class="text-cyan-400">"${key}"</span>`;
                                if (isHighlighted) {
                                    keyHtml = `<span class="${highlightClass}">${keyHtml}</span>`;
                                }

                                let showComment = false;
                                if (commentMode === "all") {
                                    showComment = true;
                                } else if (
                                    commentMode === "primitive" &&
                                    propType !== "object" &&
                                    propType !== "array"
                                ) {
                                    showComment = true;
                                }

                                const isRequired = requiredFields.has(key);
                                const requiredStatusSpan = isRequired
                                    ? `<span class="comment-required">(required)</span>`
                                    : `<span class="comment-optional">(optional)</span>`;

                                const propComment =
                                    showComment && description
                                        ? `<span class="text-gray-500 code-comment">      // ${requiredStatusSpan} ${description}</span>`
                                        : "";

                                let valueString;
                                if (
                                    propType === "object" ||
                                    propType === "array"
                                ) {
                                    valueString = _generate(
                                        propSchema,
                                        indentLevel + 1,
                                        visitedRefs,
                                        propComment
                                    );
                                } else {
                                    valueString = _generate(
                                        propSchema,
                                        indentLevel + 1,
                                        visitedRefs
                                    );
                                }

                                let line = `${childIndent}${keyHtml}: ${valueString}`;

                                if (!isLast) {
                                    line += ",";
                                }

                                if (
                                    propType !== "object" &&
                                    propType !== "array" &&
                                    propComment
                                ) {
                                    line += propComment;
                                }

                                return line;
                            });

                            return `{${comment}\n${lines.join(
                                "\n"
                            )}\n${indent}}`;

                        case "array":
                            if (currentSchema.items) {
                                const itemExample = _generate(
                                    currentSchema.items,
                                    indentLevel + 1,
                                    visitedRefs
                                );
                                return `[${comment}\n${childIndent}${itemExample}\n${indent}]`;
                            }
                            return `[]${comment}`;

                        default:
                            return getPrimitiveExampleHtml(currentSchema);
                    }
                }
                return _generate(schema, 0);
            }

            function generateExampleFromSchema(
                schema,
                swaggerJson,
                visited = new Set()
            ) {
                if (!schema) return {};
                if (schema.$ref) {
                    if (visited.has(schema.$ref))
                        return {
                            /* Circular reference */
                        };
                    visited.add(schema.$ref);
                    const resolvedSchema = resolveRef(schema.$ref, swaggerJson);
                    const result = generateExampleFromSchema(
                        resolvedSchema,
                        swaggerJson,
                        visited
                    );
                    visited.delete(schema.$ref);
                    return result;
                }

                switch (schema.type) {
                    case "object":
                        const obj = {};
                        if (schema.properties) {
                            for (const key in schema.properties) {
                                obj[key] = generateExampleFromSchema(
                                    schema.properties[key],
                                    swaggerJson,
                                    visited
                                );
                            }
                        }
                        return obj;
                    case "array":
                        if (schema.items) {
                            return [
                                generateExampleFromSchema(
                                    schema.items,
                                    swaggerJson,
                                    visited
                                ),
                            ];
                        }
                        return [];
                    case "string":
                        return "string";
                    case "integer":
                    case "number":
                        return 0;
                    case "boolean":
                        return true;
                    default:
                        if (schema.properties) {
                            const defaultObj = {};
                            for (const key in schema.properties) {
                                defaultObj[key] = generateExampleFromSchema(
                                    schema.properties[key],
                                    swaggerJson,
                                    visited
                                );
                            }
                            return defaultObj;
                        }
                        return {};
                }
            }

            function syntaxHighlight(
                jsonOrString,
                searchTerm = "",
                highlightClass = ""
            ) {
                if (jsonOrString === null)
                    return '<span class="text-gray-400">null</span>';

                let text;
                if (typeof jsonOrString != "string") {
                    text = JSON.stringify(jsonOrString, undefined, 2);
                } else {
                    text = jsonOrString;
                }

                text = text
                    .replace(/&/g, "&amp;")
                    .replace(/</g, "&lt;")
                    .replace(/>/g, "&gt;");

                return text
                    .split("\n")
                    .map((line) => {
                        const commentIndex = line.indexOf("//");
                        let codePart = line;
                        let commentPart = "";

                        if (commentIndex !== -1) {
                            codePart = line.substring(0, commentIndex);
                            commentPart = line.substring(commentIndex);
                        }

                        const codeRegex =
                            /("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g;

                        const highlightedCode = codePart.replace(
                            codeRegex,
                            function (match) {
                                let cls = "text-blue-400";
                                if (/^"/.test(match)) {
                                    if (/:$/.test(match)) {
                                        cls = "text-cyan-400";
                                        const key = match.slice(1, -2);
                                        if (
                                            searchTerm &&
                                            highlightClass &&
                                            (key
                                                .toLowerCase()
                                                .includes(searchTerm) ||
                                                (commentPart &&
                                                    commentPart
                                                        .toLowerCase()
                                                        .includes(searchTerm)))
                                        ) {
                                            return `<span class="${highlightClass}"><span class="${cls}">${match}</span></span>`;
                                        }
                                    } else {
                                        cls = "text-green-400";
                                    }
                                } else if (/true|false/.test(match)) {
                                    cls = "text-purple-400";
                                } else if (/null/.test(match)) {
                                    cls = "text-gray-400";
                                }
                                return `<span class="${cls}">${match}</span>`;
                            }
                        );

                        const highlightedComment = commentPart
                            ? `<span class="text-gray-500 code-comment">${commentPart}</span>`
                            : "";

                        return highlightedCode + highlightedComment;
                    })
                    .join("\n");
            }

            function applyMethodFilterToCard(card, filter) {
                let visibleCount = 0;
                card.querySelectorAll(".subsection-container").forEach(
                    (subSection) => {
                        let visibleEndpointsInSubsection = 0;
                        subSection
                            .querySelectorAll(".endpoint-item")
                            .forEach((item) => {
                                const isVisible =
                                    filter === "All" ||
                                    item.dataset.method === filter;
                                item.classList.toggle("hidden", !isVisible);
                                if (isVisible) {
                                    visibleEndpointsInSubsection++;
                                    visibleCount++;
                                }
                            });
                        subSection.classList.toggle(
                            "hidden",
                            visibleEndpointsInSubsection === 0
                        );
                    }
                );

                const countDisplay = card.querySelector(".api-count");
                const totalCount =
                    card.querySelectorAll(".endpoint-item").length;
                countDisplay.textContent = `${visibleCount} of ${totalCount} API Endpoint${
                    totalCount !== 1 ? "s" : ""
                }`;
            }

            function addEndpointExpansion() {
                document
                    .querySelectorAll(".endpoint-header")
                    .forEach((header) => {
                        header.addEventListener("click", () => {
                            const details =
                                header.parentElement.querySelector(
                                    ".endpoint-details"
                                );
                            const icon =
                                header.querySelector(".endpoint-chevron");
                            if (details && icon) {
                                details.classList.toggle("expanded");
                                icon.classList.toggle("rotate-180");

                                if (!details.classList.contains("expanded")) {
                                    details
                                        .querySelectorAll("details[open]")
                                        .forEach((detailElement) => {
                                            detailElement.removeAttribute(
                                                "open"
                                            );
                                        });
                                }
                            }
                        });
                    });
            }

            function updateExpandCollapseButtonsState() {
                const allCards = document.querySelectorAll(".service-card");

                if (allCards.length === 0) {
                    expandCollapseContainer.classList.add("hidden");
                    return;
                }

                expandCollapseContainer.classList.remove("hidden");
                const collapsedCards = document.querySelectorAll(
                    ".collapsible-content:not(.expanded)"
                );

                expandAllButton.disabled = collapsedCards.length === 0;
                collapseAllButton.disabled =
                    collapsedCards.length === allCards.length;
            }

            function addCollapseFunctionality() {
                document.querySelectorAll(".card-header").forEach((header) => {
                    header.addEventListener("click", () => {
                        const content = header.nextElementSibling;
                        const icon = header.querySelector(".collapse-icon");
                        content.classList.toggle("expanded");
                        icon.classList.toggle("rotate-180");

                        if (!content.classList.contains("expanded")) {
                            content
                                .querySelectorAll(".endpoint-details.expanded")
                                .forEach((details) => {
                                    details.classList.remove("expanded");
                                });
                            content
                                .querySelectorAll(
                                    ".endpoint-chevron.rotate-180"
                                )
                                .forEach((chevron) => {
                                    chevron.classList.remove("rotate-180");
                                });
                            content
                                .querySelectorAll("details[open]")
                                .forEach((details) => {
                                    details.removeAttribute("open");
                                });
                        }

                        updateExpandCollapseButtonsState();
                    });
                });
            }

            expandAllButton.addEventListener("click", () => {
                document.querySelectorAll(".service-card").forEach((card) => {
                    const content = card.querySelector(".collapsible-content");
                    const icon = card.querySelector(".collapse-icon");
                    content.classList.add("expanded");
                    icon.classList.remove("rotate-180");
                });
                updateExpandCollapseButtonsState();
            });

            collapseAllButton.addEventListener("click", () => {
                document.querySelectorAll(".service-card").forEach((card) => {
                    const content = card.querySelector(".collapsible-content");
                    const icon = card.querySelector(".collapse-icon");
                    content.classList.remove("expanded");
                    icon.classList.add("rotate-180");

                    content
                        .querySelectorAll(".endpoint-details.expanded")
                        .forEach((details) => {
                            details.classList.remove("expanded");
                        });
                    content
                        .querySelectorAll(".endpoint-chevron.rotate-180")
                        .forEach((chevron) => {
                            chevron.classList.remove("rotate-180");
                        });
                    content
                        .querySelectorAll("details[open]")
                        .forEach((details) => {
                            details.removeAttribute("open");
                        });
                });
                updateExpandCollapseButtonsState();
            });

            function addMethodFiltering() {
                document.querySelectorAll(".service-card").forEach((card) => {
                    const controls = card.querySelector(
                        ".method-filter-controls"
                    );
                    if (!controls) return;

                    controls.addEventListener("click", (e) => {
                        if (
                            e.target.tagName !== "BUTTON" ||
                            !e.target.dataset.filterMethod
                        )
                            return;
                        const filter = e.target.dataset.filterMethod;
                        const serviceId = card.id;

                        activeMethodFilters[serviceId] = filter;
                        if (filter === "All") {
                            delete activeMethodFilters[serviceId];
                        }

                        controls
                            .querySelectorAll(".method-filter-btn")
                            .forEach((btn) => {
                                btn.className =
                                    "method-filter-btn px-3 py-1 text-sm font-medium rounded-md transition bg-gray-200 hover:bg-gray-300 text-gray-800 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-300";
                            });

                        e.target.classList.remove(
                            "bg-gray-200",
                            "hover:bg-gray-300",
                            "text-gray-800",
                            "dark:bg-gray-700",
                            "dark:hover:bg-gray-600",
                            "dark:text-gray-300"
                        );
                        if (filter === "All") {
                            e.target.classList.add("bg-blue-600", "text-white");
                        } else {
                            e.target.classList.add(
                                getMethodColor(filter),
                                "text-white"
                            );
                        }

                        applyMethodFilterToCard(card, filter);
                        updateResetButtonState();
                        updateTotalCount();
                    });
                });
            }

            function updateTotalCount() {
                const totalCount = document.querySelectorAll(
                    ".endpoint-item:not(.hidden)"
                ).length;
                totalApiCountEl.textContent = `Showing ${totalCount} API Endpoint${
                    totalCount !== 1 ? "s" : ""
                }`;
            }

            function updateResetButtonState() {
                const hasActiveFilters =
                    Object.keys(activeMethodFilters).length > 0;
                resetFiltersButton.disabled = !hasActiveFilters;
            }

            function updateSortButtonsState() {
                if (currentSortState === "original") {
                    sortAZButton.disabled = false;
                    resetSortButton.disabled = true;
                } else {
                    sortAZButton.disabled = true;
                    resetSortButton.disabled = false;
                }
            }

            resetFiltersButton.addEventListener("click", () => {
                activeMethodFilters = {};
                document.querySelectorAll(".service-card").forEach((card) => {
                    const controls = card.querySelector(
                        ".method-filter-controls"
                    );
                    if (controls) {
                        controls
                            .querySelectorAll(".method-filter-btn")
                            .forEach((btn) => {
                                btn.className =
                                    "method-filter-btn px-3 py-1 text-sm font-medium rounded-md transition bg-gray-200 hover:bg-gray-300 text-gray-800 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-300";
                            });
                        const allButton = controls.querySelector(
                            '[data-filter-method="All"]'
                        );
                        if (allButton) {
                            allButton.classList.remove(
                                "bg-gray-200",
                                "hover:bg-gray-300",
                                "text-gray-800",
                                "dark:bg-gray-700",
                                "dark:hover:bg-gray-600",
                                "dark:text-gray-300"
                            );
                            allButton.classList.add(
                                "bg-blue-600",
                                "text-white"
                            );
                        }
                    }
                    applyMethodFilterToCard(card, "All");
                });
                updateResetButtonState();
                updateTotalCount();
            });

            sortAZButton.addEventListener("click", () => {
                allServiceDetails.sort((a, b) =>
                    a.service.app.localeCompare(b.service.app)
                );
                currentSortState = "az";
                updateSortButtonsState();
                triggerSearchAndRender();
            });

            resetSortButton.addEventListener("click", () => {
                allServiceDetails = [...originalServiceDetails];
                currentSortState = "original";
                updateSortButtonsState();
                triggerSearchAndRender();
            });

            function schemaHasProperty(
                schema,
                propName,
                swaggerJson,
                visited = new Set(),
                includeDesc = false
            ) {
                if (!schema) return false;

                if (schema.$ref) {
                    if (visited.has(schema.$ref)) return false; // Avoid circular loops
                    visited.add(schema.$ref);
                    const resolvedSchema = resolveRef(schema.$ref, swaggerJson);
                    const result = schemaHasProperty(
                        resolvedSchema,
                        propName,
                        swaggerJson,
                        visited,
                        includeDesc
                    );
                    visited.delete(schema.$ref);
                    return result;
                }

                if (schema.properties) {
                    for (const key in schema.properties) {
                        const propSchema = schema.properties[key];
                        if (key.toLowerCase().includes(propName)) {
                            return true;
                        }
                        if (
                            includeDesc &&
                            propSchema.description &&
                            propSchema.description
                                .toLowerCase()
                                .includes(propName)
                        ) {
                            return true;
                        }
                        if (
                            schemaHasProperty(
                                propSchema,
                                propName,
                                swaggerJson,
                                visited,
                                includeDesc
                            )
                        ) {
                            return true;
                        }
                    }
                }

                if (schema.items) {
                    return schemaHasProperty(
                        schema.items,
                        propName,
                        swaggerJson,
                        visited,
                        includeDesc
                    );
                }

                return false;
            }

            function triggerSearchAndRender() {
                const expansionStates = {};
                document.querySelectorAll(".service-card").forEach((card) => {
                    expansionStates[card.id] = card
                        .querySelector(".collapsible-content")
                        .classList.contains("expanded");
                });

                const searchTerm = searchInput.value.toLowerCase().trim();
                const includePathDesc = pathIncludeDescCheck.checked;
                const paramSearchTerm = paramSearchInput.value
                    .toLowerCase()
                    .trim();
                const includeParamDesc = paramIncludeDescCheck.checked;
                const bodySearchTerm = bodySearchInput.value
                    .toLowerCase()
                    .trim();
                const includeBodyDesc = bodyIncludeDescCheck.checked;
                const responseSearchTerm = responseSearchInput.value
                    .toLowerCase()
                    .trim();
                const includeResponseDesc = responseIncludeDescCheck.checked;
                const servicesToProcess = allServiceDetails;

                const filteredServices = JSON.parse(
                    JSON.stringify(servicesToProcess)
                ).map((detail) => {
                    if (!detail.swaggerJson || !detail.swaggerJson.paths)
                        return detail;
                    const filteredPaths = {};
                    for (const path in detail.swaggerJson.paths) {
                        for (const method in detail.swaggerJson.paths[path]) {
                            const endpoint =
                                detail.swaggerJson.paths[path][method];

                            const summary = (
                                endpoint.summary || ""
                            ).toLowerCase();
                            const pathString = path.toLowerCase();
                            let pathOrSummaryMatch;
                            if (searchTerm === "") {
                                pathOrSummaryMatch = true;
                            } else {
                                const pathMatch =
                                    pathString.includes(searchTerm);
                                if (includePathDesc) {
                                    const summaryMatch =
                                        summary.includes(searchTerm);
                                    pathOrSummaryMatch =
                                        pathMatch || summaryMatch;
                                } else {
                                    pathOrSummaryMatch = pathMatch;
                                }
                            }

                            let paramMatch = paramSearchTerm === "";
                            if (!paramMatch && endpoint.parameters) {
                                paramMatch = endpoint.parameters.some((p) => {
                                    if (p.in === "body") {
                                        return false;
                                    }
                                    const nameMatch = p.name
                                        .toLowerCase()
                                        .includes(paramSearchTerm);
                                    if (includeParamDesc) {
                                        const descMatch = p.description
                                            ? p.description
                                                  .toLowerCase()
                                                  .includes(paramSearchTerm)
                                            : false;
                                        return nameMatch || descMatch;
                                    }
                                    return nameMatch;
                                });
                            }

                            let bodyMatch = bodySearchTerm === "";
                            if (!bodyMatch && endpoint.parameters) {
                                const bodyParam = endpoint.parameters.find(
                                    (p) => p.in === "body"
                                );
                                if (bodyParam && bodyParam.schema) {
                                    bodyMatch = schemaHasProperty(
                                        bodyParam.schema,
                                        bodySearchTerm,
                                        detail.swaggerJson,
                                        new Set(),
                                        includeBodyDesc
                                    );
                                }
                            }

                            let responseMatch = responseSearchTerm === "";
                            if (!responseMatch && endpoint.responses) {
                                responseMatch = Object.values(
                                    endpoint.responses
                                ).some(
                                    (resp) =>
                                        resp.schema &&
                                        schemaHasProperty(
                                            resp.schema,
                                            responseSearchTerm,
                                            detail.swaggerJson,
                                            new Set(),
                                            includeResponseDesc
                                        )
                                );
                            }

                            if (
                                pathOrSummaryMatch &&
                                paramMatch &&
                                bodyMatch &&
                                responseMatch
                            ) {
                                if (!filteredPaths[path])
                                    filteredPaths[path] = {};
                                filteredPaths[path][method] = endpoint;
                            }
                        }
                    }
                    detail.swaggerJson.paths = filteredPaths;
                    return detail;
                });

                renderServices(filteredServices, expansionStates);
            }

            function setView(detailed, preventRender = false) {
                isDetailedView = detailed;
                const transformValue = detailed
                    ? "translateX(100%)"
                    : "translateX(0)";

                const activeClasses = ["text-blue-600", "dark:text-blue-400"];
                const inactiveClasses = ["text-gray-600", "dark:text-gray-400"];

                const applyClasses = (button, isActive) => {
                    if (button) {
                        button.classList.remove(
                            ...activeClasses,
                            ...inactiveClasses
                        );
                        button.classList.add(
                            ...(isActive ? activeClasses : inactiveClasses)
                        );
                    }
                };

                applyClasses(simpleViewBtn, !detailed);
                applyClasses(detailedViewBtn, detailed);
                applyClasses(stickySimpleViewBtn, !detailed);
                applyClasses(stickyDetailedViewBtn, detailed);

                if (document.getElementById("view-toggle-indicator")) {
                    document.getElementById(
                        "view-toggle-indicator"
                    ).style.transform = transformValue;
                }
                if (document.getElementById("sticky-view-toggle-indicator")) {
                    document.getElementById(
                        "sticky-view-toggle-indicator"
                    ).style.transform = transformValue;
                }

                if (
                    !preventRender &&
                    document.body.contains(searchContainer) &&
                    !searchContainer.classList.contains("hidden")
                ) {
                    triggerSearchAndRender();
                }
            }

            document.addEventListener("DOMContentLoaded", () => {
                setView(isDetailedView, true);
                updateClearAllButtonState();
                if (toggleStickySearchBtn) {
                    toggleStickySearchBtn.addEventListener("click", () => {
                        stickySearchArea.classList.toggle("expanded");
                        toggleStickySearchIcon.classList.toggle("rotate-180");
                    });
                }
            });

            simpleViewBtn.addEventListener("click", () => setView(false));
            detailedViewBtn.addEventListener("click", () => setView(true));
            stickySimpleViewBtn.addEventListener("click", () => setView(false));
            stickyDetailedViewBtn.addEventListener("click", () =>
                setView(true)
            );

            function updateClearAllButtonState() {
                const hasValue =
                    searchInput.value.trim() !== "" ||
                    paramSearchInput.value.trim() !== "" ||
                    bodySearchInput.value.trim() !== "" ||
                    responseSearchInput.value.trim() !== "" ||
                    pathIncludeDescCheck.checked ||
                    paramIncludeDescCheck.checked ||
                    bodyIncludeDescCheck.checked ||
                    responseIncludeDescCheck.checked;

                if (clearAllButton) clearAllButton.disabled = !hasValue;
            }

            function handleSearchInput() {
                const searchTerm = searchInput.value.toLowerCase().trim();
                const paramSearchTerm = paramSearchInput.value
                    .toLowerCase()
                    .trim();
                const bodySearchTerm = bodySearchInput.value
                    .toLowerCase()
                    .trim();
                const responseSearchTerm = responseSearchInput.value
                    .toLowerCase()
                    .trim();

                clearSearchInputBtn.classList.toggle(
                    "hidden",
                    searchTerm.length === 0
                );
                stickyClearSearchInputBtn.classList.toggle(
                    "hidden",
                    searchTerm.length === 0
                );
                clearParamSearchInputBtn.classList.toggle(
                    "hidden",
                    paramSearchTerm.length === 0
                );
                stickyClearParamSearchInputBtn.classList.toggle(
                    "hidden",
                    paramSearchTerm.length === 0
                );
                clearBodySearchInputBtn.classList.toggle(
                    "hidden",
                    bodySearchTerm.length === 0
                );
                stickyClearBodySearchInputBtn.classList.toggle(
                    "hidden",
                    bodySearchTerm.length === 0
                );
                clearResponseSearchInputBtn.classList.toggle(
                    "hidden",
                    responseSearchTerm.length === 0
                );
                stickyClearResponseSearchInputBtn.classList.toggle(
                    "hidden",
                    responseSearchTerm.length === 0
                );

                updateClearAllButtonState();
                triggerSearchAndRender();
            }

            stickySearchInput.addEventListener("input", () => {
                searchInput.value = stickySearchInput.value;
                handleSearchInput();
            });
            searchInput.addEventListener("input", () => {
                stickySearchInput.value = searchInput.value;
                handleSearchInput();
            });
            stickyParamSearchInput.addEventListener("input", () => {
                paramSearchInput.value = stickyParamSearchInput.value;
                handleSearchInput();
            });
            paramSearchInput.addEventListener("input", () => {
                stickyParamSearchInput.value = paramSearchInput.value;
                handleSearchInput();
            });
            stickyBodySearchInput.addEventListener("input", () => {
                bodySearchInput.value = stickyBodySearchInput.value;
                handleSearchInput();
            });
            bodySearchInput.addEventListener("input", () => {
                stickyBodySearchInput.value = bodySearchInput.value;
                handleSearchInput();
            });
            stickyResponseSearchInput.addEventListener("input", () => {
                responseSearchInput.value = stickyResponseSearchInput.value;
                handleSearchInput();
            });
            responseSearchInput.addEventListener("input", () => {
                stickyResponseSearchInput.value = responseSearchInput.value;
                handleSearchInput();
            });

            pathIncludeDescCheck.addEventListener("change", () => {
                stickyPathIncludeDescCheck.checked =
                    pathIncludeDescCheck.checked;
                handleSearchInput();
            });
            stickyPathIncludeDescCheck.addEventListener("change", () => {
                pathIncludeDescCheck.checked =
                    stickyPathIncludeDescCheck.checked;
                handleSearchInput();
            });

            paramIncludeDescCheck.addEventListener("change", () => {
                stickyParamIncludeDescCheck.checked =
                    paramIncludeDescCheck.checked;
                handleSearchInput();
            });
            stickyParamIncludeDescCheck.addEventListener("change", () => {
                paramIncludeDescCheck.checked =
                    stickyParamIncludeDescCheck.checked;
                handleSearchInput();
            });

            bodyIncludeDescCheck.addEventListener("change", () => {
                stickyBodyIncludeDescCheck.checked =
                    bodyIncludeDescCheck.checked;
                handleSearchInput();
            });
            stickyBodyIncludeDescCheck.addEventListener("change", () => {
                bodyIncludeDescCheck.checked =
                    stickyBodyIncludeDescCheck.checked;
                handleSearchInput();
            });

            responseIncludeDescCheck.addEventListener("change", () => {
                stickyResponseIncludeDescCheck.checked =
                    responseIncludeDescCheck.checked;
                handleSearchInput();
            });
            stickyResponseIncludeDescCheck.addEventListener("change", () => {
                responseIncludeDescCheck.checked =
                    stickyResponseIncludeDescCheck.checked;
                handleSearchInput();
            });

            function flashViewToggle() {
                const mainToggle =
                    document.getElementById("view-toggle-switch");
                const stickyToggle = document.getElementById(
                    "sticky-view-toggle-switch"
                );
                const elements = [mainToggle, stickyToggle].filter((el) => el);

                elements.forEach((el) => {
                    const originalBg = "bg-gray-200";
                    const originalDarkBg = "dark:bg-gray-700";
                    // Using brighter colors to make the flash more noticeable
                    const flashBg = "bg-yellow-300";
                    const flashDarkBg = "dark:bg-yellow-700/60";

                    el.classList.remove(originalBg, originalDarkBg);
                    el.classList.add(flashBg, flashDarkBg);

                    setTimeout(() => {
                        el.classList.remove(flashBg, flashDarkBg);
                        el.classList.add(originalBg, originalDarkBg);
                    }, 1200);
                });
            }

            function clearAllInputs() {
                if (isDetailedView) {
                    flashViewToggle();
                    setView(false, true); // Reset to simple view, prevent re-render from here
                }
                // Clear main inputs
                searchInput.value = "";
                paramSearchInput.value = "";
                bodySearchInput.value = "";
                responseSearchInput.value = "";

                // Clear sticky inputs
                stickySearchInput.value = "";
                stickyParamSearchInput.value = "";
                stickyBodySearchInput.value = "";
                stickyResponseSearchInput.value = "";

                // Uncheck main checkboxes
                pathIncludeDescCheck.checked = false;
                paramIncludeDescCheck.checked = false;
                bodyIncludeDescCheck.checked = false;
                responseIncludeDescCheck.checked = false;

                // Uncheck sticky checkboxes
                stickyPathIncludeDescCheck.checked = false;
                stickyParamIncludeDescCheck.checked = false;
                stickyBodyIncludeDescCheck.checked = false;
                stickyResponseIncludeDescCheck.checked = false;

                // Trigger re-render and update UI state
                handleSearchInput();
            }

            clearAllButton.addEventListener("click", clearAllInputs);

            function clearAndCheckView() {
                const allEmpty =
                    searchInput.value.trim() === "" &&
                    paramSearchInput.value.trim() === "" &&
                    bodySearchInput.value.trim() === "" &&
                    responseSearchInput.value.trim() === "";
                if (isDetailedView && allEmpty) {
                    flashViewToggle();
                    setView(false);
                }
            }

            function clearMainSearch() {
                searchInput.value = "";
                stickySearchInput.value = "";
                handleSearchInput();
                clearAndCheckView();
            }

            function clearParamSearch() {
                paramSearchInput.value = "";
                stickyParamSearchInput.value = "";
                handleSearchInput();
                clearAndCheckView();
            }

            function clearBodySearch() {
                bodySearchInput.value = "";
                stickyBodySearchInput.value = "";
                handleSearchInput();
                clearAndCheckView();
            }

            function clearResponseSearch() {
                responseSearchInput.value = "";
                stickyResponseSearchInput.value = "";
                handleSearchInput();
                clearAndCheckView();
            }

            clearSearchInputBtn.addEventListener("click", clearMainSearch);
            stickyClearSearchInputBtn.addEventListener(
                "click",
                clearMainSearch
            );
            clearParamSearchInputBtn.addEventListener(
                "click",
                clearParamSearch
            );
            stickyClearParamSearchInputBtn.addEventListener(
                "click",
                clearParamSearch
            );
            clearBodySearchInputBtn.addEventListener("click", clearBodySearch);
            stickyClearBodySearchInputBtn.addEventListener(
                "click",
                clearBodySearch
            );
            clearResponseSearchInputBtn.addEventListener(
                "click",
                clearResponseSearch
            );
            stickyClearResponseSearchInputBtn.addEventListener(
                "click",
                clearResponseSearch
            );

            window.onscroll = () => {
                toTopButton.classList.toggle(
                    "hidden",
                    document.body.scrollTop <= 100 &&
                        document.documentElement.scrollTop <= 100
                );

                if (
                    searchContainer &&
                    stickyHeader &&
                    searchContainer.offsetParent !== null
                ) {
                    const rect = searchContainer.getBoundingClientRect();
                    if (rect.bottom < 10) {
                        stickyHeader.classList.remove("-translate-y-full");
                    } else {
                        stickyHeader.classList.add("-translate-y-full");
                    }
                }
            };

            toTopButton.addEventListener("click", () => {
                window.scrollTo({ top: 0, behavior: "smooth" });
            });

            function getMethodColor(method) {
                const colors = {
                    GET: "bg-green-600",
                    POST: "bg-purple-600",
                    PUT: "bg-orange-500",
                    DELETE: "bg-red-600",
                    PATCH: "bg-yellow-500",
                };
                return colors[method] || "bg-gray-500";
            }

            function showError(message) {
                errorMessage.textContent = message;
                errorBox.classList.remove("hidden");
            }

            function hideError() {
                errorBox.classList.add("hidden");
            }
        </script>
    </body>
</html>
